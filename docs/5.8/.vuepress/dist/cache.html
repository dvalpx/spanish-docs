<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Caché | Documentación de Laravel en Español</title>
    <meta name="description" content="Documentación de Laravel en Español">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Catamaran:300,700|Miriam+Libre">
    
    <link rel="preload" href="/assets/css/0.styles.0cc2d3c3.css" as="style"><link rel="preload" href="/assets/js/app.bf22240a.js" as="script"><link rel="preload" href="/assets/js/15.abc982c9.js" as="script"><link rel="prefetch" href="/assets/js/10.8a8a99df.js"><link rel="prefetch" href="/assets/js/11.ec476e2f.js"><link rel="prefetch" href="/assets/js/12.6db1eb13.js"><link rel="prefetch" href="/assets/js/13.92d78bb5.js"><link rel="prefetch" href="/assets/js/14.1a0ad5f1.js"><link rel="prefetch" href="/assets/js/16.7cf1a759.js"><link rel="prefetch" href="/assets/js/17.4abfc664.js"><link rel="prefetch" href="/assets/js/18.85b19837.js"><link rel="prefetch" href="/assets/js/19.8c9dfcd5.js"><link rel="prefetch" href="/assets/js/2.dcb6cf45.js"><link rel="prefetch" href="/assets/js/20.c1b9de54.js"><link rel="prefetch" href="/assets/js/21.469ffab3.js"><link rel="prefetch" href="/assets/js/22.2d14e150.js"><link rel="prefetch" href="/assets/js/23.7a4dcc9a.js"><link rel="prefetch" href="/assets/js/24.534e59f1.js"><link rel="prefetch" href="/assets/js/25.eaac1c07.js"><link rel="prefetch" href="/assets/js/26.8e9180e0.js"><link rel="prefetch" href="/assets/js/27.2cd2ace8.js"><link rel="prefetch" href="/assets/js/28.9f7dcf6d.js"><link rel="prefetch" href="/assets/js/29.06a87f0d.js"><link rel="prefetch" href="/assets/js/3.b62bf0b4.js"><link rel="prefetch" href="/assets/js/30.b03f86ec.js"><link rel="prefetch" href="/assets/js/31.edce81f6.js"><link rel="prefetch" href="/assets/js/32.6657300b.js"><link rel="prefetch" href="/assets/js/33.8dc49209.js"><link rel="prefetch" href="/assets/js/34.03cbee56.js"><link rel="prefetch" href="/assets/js/35.5439db2e.js"><link rel="prefetch" href="/assets/js/36.83d5a264.js"><link rel="prefetch" href="/assets/js/37.4066824e.js"><link rel="prefetch" href="/assets/js/38.c3fe05aa.js"><link rel="prefetch" href="/assets/js/39.52ef8667.js"><link rel="prefetch" href="/assets/js/4.bd0ebba2.js"><link rel="prefetch" href="/assets/js/40.2c54d702.js"><link rel="prefetch" href="/assets/js/41.775bc6e1.js"><link rel="prefetch" href="/assets/js/42.6541d60b.js"><link rel="prefetch" href="/assets/js/43.20091aea.js"><link rel="prefetch" href="/assets/js/44.75b71ccc.js"><link rel="prefetch" href="/assets/js/45.6b36a3a8.js"><link rel="prefetch" href="/assets/js/46.6ea236af.js"><link rel="prefetch" href="/assets/js/47.0e0ee374.js"><link rel="prefetch" href="/assets/js/48.b6beb9b8.js"><link rel="prefetch" href="/assets/js/49.ae33b521.js"><link rel="prefetch" href="/assets/js/5.2c350d8b.js"><link rel="prefetch" href="/assets/js/50.5cb081e0.js"><link rel="prefetch" href="/assets/js/51.3e0281e2.js"><link rel="prefetch" href="/assets/js/52.e1fae1d6.js"><link rel="prefetch" href="/assets/js/53.0a9d4aed.js"><link rel="prefetch" href="/assets/js/54.55bc9113.js"><link rel="prefetch" href="/assets/js/55.e964fdb4.js"><link rel="prefetch" href="/assets/js/56.3abed8a0.js"><link rel="prefetch" href="/assets/js/57.df09269b.js"><link rel="prefetch" href="/assets/js/58.3ce37458.js"><link rel="prefetch" href="/assets/js/59.7a840aeb.js"><link rel="prefetch" href="/assets/js/6.6fce793d.js"><link rel="prefetch" href="/assets/js/60.b4fe788b.js"><link rel="prefetch" href="/assets/js/61.e45356bb.js"><link rel="prefetch" href="/assets/js/62.0d75cf78.js"><link rel="prefetch" href="/assets/js/63.0ecae205.js"><link rel="prefetch" href="/assets/js/64.90fb2c2d.js"><link rel="prefetch" href="/assets/js/65.7c476002.js"><link rel="prefetch" href="/assets/js/66.802dee8b.js"><link rel="prefetch" href="/assets/js/67.ae965c66.js"><link rel="prefetch" href="/assets/js/68.220c04d8.js"><link rel="prefetch" href="/assets/js/69.bf607b92.js"><link rel="prefetch" href="/assets/js/7.b956f78c.js"><link rel="prefetch" href="/assets/js/70.dea3d878.js"><link rel="prefetch" href="/assets/js/71.1f786e34.js"><link rel="prefetch" href="/assets/js/72.4bd65b39.js"><link rel="prefetch" href="/assets/js/73.414b29bd.js"><link rel="prefetch" href="/assets/js/74.b5ab4f13.js"><link rel="prefetch" href="/assets/js/75.f12fbb27.js"><link rel="prefetch" href="/assets/js/76.a140d22b.js"><link rel="prefetch" href="/assets/js/77.2595933c.js"><link rel="prefetch" href="/assets/js/78.46bb4eff.js"><link rel="prefetch" href="/assets/js/79.c549a0e3.js"><link rel="prefetch" href="/assets/js/8.3be12d8d.js"><link rel="prefetch" href="/assets/js/80.1b9cd731.js"><link rel="prefetch" href="/assets/js/81.6aa05825.js"><link rel="prefetch" href="/assets/js/9.60a01cba.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0cc2d3c3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Documentación de Laravel en Español</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Inicio</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Inicio</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Primeros Pasos</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Conceptos De Arquitectura</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Fundamentos</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Frontend</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Seguridad</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Profundizando</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/artisan.html" class="sidebar-link">Consola Artisan</a></li><li><a href="/broadcasting.html" class="sidebar-link">Broadcasting</a></li><li><a href="/cache.html" class="active sidebar-link">Caché</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cache.html#configuracion" class="sidebar-link">Configuración</a></li><li class="sidebar-sub-header"><a href="/cache.html#uso-de-cache" class="sidebar-link">Uso De Caché</a></li><li class="sidebar-sub-header"><a href="/cache.html#cache-tags" class="sidebar-link">Cache Tags</a></li><li class="sidebar-sub-header"><a href="/cache.html#agregar-controladores-de-cache-personalizados" class="sidebar-link">Agregar Controladores De Caché Personalizados</a></li><li class="sidebar-sub-header"><a href="/cache.html#eventos" class="sidebar-link">Eventos</a></li></ul></li><li><a href="/collections.html" class="sidebar-link">Collecciones</a></li><li><a href="/events.html" class="sidebar-link">Eventos</a></li><li><a href="/filesystem.html" class="sidebar-link">Almacenamiento De Archivos</a></li><li><a href="/helpers.html" class="sidebar-link">Helpers</a></li><li><a href="/mail.html" class="sidebar-link">Correos Electrónicos</a></li><li><a href="/notifications.html" class="sidebar-link">Notificaciones</a></li><li><a href="/packages.html" class="sidebar-link">Desarrollo de Paquetes</a></li><li><a href="/queues.html" class="sidebar-link">Colas De Trabajo</a></li><li><a href="/scheduling.html" class="sidebar-link">Programación de tareas</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Bases De Datos</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ORM Eloquent</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Pruebas</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Paquetes oficiales</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><div><h1 id="cache"><a class="header-anchor" href="#cache" aria-hidden="true">#</a> Caché</h1> <ul><li><a href="#configuration">Configuración</a> <ul><li><a href="#driver-prerequisites">Prerrequisitos Del Controlador</a></li></ul></li> <li><a href="#cache-usage">Uso De Caché</a> <ul><li><a href="#obtaining-a-cache-instance">Obtener Una Instancia De Caché</a></li> <li><a href="#retrieving-items-from-the-cache">Recuperar Elementos De Caché</a></li> <li><a href="#storing-items-in-the-cache">Almacenar Elementos En Caché</a></li> <li><a href="#removing-items-from-the-cache">Eliminar Elementos De Caché</a></li> <li><a href="#atomic-locks">Cierres Atómicos</a></li> <li><a href="#the-cache-helper">El Helper Cache</a></li></ul></li> <li><a href="#cache-tags">Etiquetas De Caché</a> <ul><li><a href="#storing-tagged-cache-items">Almacenar Elementos De Caché Etiquetados</a></li> <li><a href="#accessing-tagged-cache-items">Acceder A Elementos De Caché Etiquetados</a></li> <li><a href="#removing-tagged-cache-items">Eliminar Elementos De Caché Etiquetados</a></li></ul></li> <li><a href="#adding-custom-cache-drivers">Agregar Controladores De Caché Personalizados</a> <ul><li><a href="#writing-the-driver">Escribir El Driver</a></li> <li><a href="#registering-the-driver">Registrar El Driver</a></li></ul></li> <li><a href="#events">Eventos</a></li></ul> <p><a name="configuration"></a></p> <h2 id="configuracion"><a class="header-anchor" href="#configuracion" aria-hidden="true">#</a> Configuración</h2> <p>Laravel proporciona una API expresiva y unificada para varios backends de almacenamiento de caché. La configuración de caché está ubicada en <code>config/cache.php</code>. En este archivo puedes indicar el controlador de caché que desees utilizar por defecto en toda tu aplicación. Por defecto, Laravel es compatible con los almacenamientos en caché más populares, tales como <a href="https://memcached.org" target="_blank" rel="noopener noreferrer">Memcached<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> y <a href="https://redis.io" target="_blank" rel="noopener noreferrer">Redis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>El archivo de configuración de caché contiene otras opciones adicionales, las cuales están documentadas dentro del mismo archivo, por lo que deberás asegurarte de revisar estas opciones. Por defecto, Laravel está configurado para utilizar el controlador de caché <code>local</code>, que almacena los objetos de caché serializados en el sistema de archivos. Para aplicaciones más grandes, es recomendable que utilices un controlador más robusto como Memcached o Redis. Incluso puedes configurar múltiples configuraciones de caché para el mismo controlador.</p> <p><a name="driver-prerequisites"></a></p> <h3 id="prerrequisitos-del-controlador"><a class="header-anchor" href="#prerrequisitos-del-controlador" aria-hidden="true">#</a> Prerrequisitos Del Controlador</h3> <h4 id="base-de-datos"><a class="header-anchor" href="#base-de-datos" aria-hidden="true">#</a> Base de datos</h4> <p>Cuando utilices el controlador de caché <code>database</code>, necesitarás configurar una tabla que contenga los elementos de caché. Puedes encontrar un <code>Schema</code> de ejemplo en la tabla inferior:</p> <div class="language-php extra-class"><pre v-pre class="language-php"><code>Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'cache'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'expiration'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>También puedes utilizar el comando <code>php artisan cache:table</code> para generar una migración con el esquema apropiado.</p></div></div> <h4 id="memcached"><a href="#memcached" aria-hidden="true" class="header-anchor">#</a> Memcached</h4> <p>Utilizar el controlador Memcached requiere que tengas instalado el <a href="https://pecl.php.net/package/memcached" target="_blank" rel="noopener noreferrer">paquete de Memcached PECL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Puedes listar todos tus servidores de Memcached en el archivo de configuración <code>config/cache.php</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token single-quoted-string string">'memcached'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'host'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'127.0.0.1'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'port'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">11211</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'weight'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">100</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>También puedes establecer la opción <code>host</code> a la ruta de un socket de UNIX. Si haces esto, la opción <code>port</code> se debe establecer a <code>0</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token single-quoted-string string">'memcached'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'host'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'/var/run/memcached/memcached.sock'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'port'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'weight'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">100</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="redis"><a href="#redis" aria-hidden="true" class="header-anchor">#</a> Redis</h4> <p>Antes de comenzar a utilizar el caché con Redis en Laravel, deberás instalar el paquete <code>predis/predis</code> (~1.0) por medio de Composer o instalar la extensión de PHP PhpRedis por medio de PECL.</p> <p>Para más información sobre cómo configurar Redis, consulta la <a href="/docs/%7B%7Bversion%7D%7D/redis#configuration">página de la documentación de Laravel</a>.</p> <p><a name="cache-usage"></a></p> <h2 id="uso-de-cache"><a href="#uso-de-cache" aria-hidden="true" class="header-anchor">#</a> Uso De Caché</h2> <p><a name="obtaining-a-cache-instance"></a></p> <h3 id="obtener-una-instancia-de-cache"><a href="#obtener-una-instancia-de-cache" aria-hidden="true" class="header-anchor">#</a> Obtener Una Instancia De Caché</h3> <p>Las <a href="/docs/%7B%7Bversion%7D%7D/contracts">interfaces</a> <code>Illuminate\Contracts\Cache\Factory</code> y <code>Illuminate\Contracts\Cache\Repository</code> proporcionan acceso a los servicios de caché de Laravel. La interfaz <code>Factory</code> proporciona acceso a todos los controladores de caché definidos para tu aplicación. La interfaz <code>Repository</code> típicamente es una implementación del controlador de caché predeterminado para tu aplicación según lo especificado en tu archivo de configuración de <code>cache</code>.</p> <p>Sin embargo, también puedes usar el facade <code>Cache</code>, que es lo que usaremos a lo largo de esta documentación. El facade <code>Cache</code> proporciona acceso conveniente y directo a las implementaciones subyacientes de las interfaces de Laravel.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Cache</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Show a list of all users of the application.
    *
    * @return Response
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$value</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h4 id="acceder-a-multiples-almacenamientos-de-cache"><a href="#acceder-a-multiples-almacenamientos-de-cache" aria-hidden="true" class="header-anchor">#</a> Acceder A Múltiples Almacenamientos De Caché</h4> <p>Usando el facade <code>Cache</code>, puedes acceder a varios almacenamientos de caché a través del método <code>store</code>. La llave que se pasa al método <code>store</code> debe corresponder a uno de los almacenamientos listados en el arreglo de configuración <code>stores</code> en tu archivo de configuración <code>cache</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$value</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">store</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">store</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'redis'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'baz'</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10 Minutes</span>
</code></pre></div><p><a name="retrieving-items-from-the-cache"></a></p> <h3 id="recuperar-elementos-de-cache"><a href="#recuperar-elementos-de-cache" aria-hidden="true" class="header-anchor">#</a> Recuperar Elementos De Caché</h3> <p>El método <code>get</code> en el facade <code>Cache</code> es utilizado para recuperar elementos desde la caché. Si el elemento no existe en caché, se va a regresar <code>null</code>. Si lo deseas, puedes pasar un segundo argumento al método <code>get</code> indicando el valor predeterminado que deseas retornar en caso de que el elemento no exista:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$value</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$value</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Incluso puedes pasar una <code>Closure</code> como valor predeterminado. El resultado del <code>Closure</code> será devuelto si el elemento especificado no existe en caché. Pasar un Closure te permite diferir la recuperación de valores predeterminados de una base de datos a otro servicio externo:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$value</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token constant">DB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="comprobar-la-existencia-de-un-elemento"><a href="#comprobar-la-existencia-de-un-elemento" aria-hidden="true" class="header-anchor">#</a> Comprobar La Existencia De Un Elemento</h4> <p>El método <code>has</code> se puede utilizar para determinar la existencia de un elemento en caché. Este método devolverá <code>false</code> si el valor es <code>null</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="incrementando-decrementando-valores"><a href="#incrementando-decrementando-valores" aria-hidden="true" class="header-anchor">#</a> Incrementando / Decrementando Valores</h4> <p>Los métodos <code>increment</code> y <code>decrement</code> se pueden usar para ajustar el valor de los elementos enteros en caché. Ambos métodos aceptan un segundo parámetro opcional que indica la cantidad por la cual incrementar o disminuir el valor del elemento:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token variable">$amount</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">decrement</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">decrement</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token variable">$amount</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="recuperar-y-almacenar"><a href="#recuperar-y-almacenar" aria-hidden="true" class="header-anchor">#</a> Recuperar Y Almacenar</h4> <p>En ocasiones, es posible que desees recuperar un elemento de la memoria caché, pero también almacenar un valor predeterminado si el elemento no existe. Por ejemplo, puede que desees recuperar todos los usuarios de la memoria caché o, si no existen, recuperarlos desde la base de datos y agregarlos a la caché. Puedes hacer esto utilizando el método <code>Cache::remember</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$value</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">remember</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">,</span> <span class="token variable">$seconds</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token constant">DB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si el elemento no existe en la memoria caché, se ejecutará el <code>Closure</code> pasado al método <code>remember</code> y su resultado se colocará en caché.</p> <p>Puedes utilizar el método <code>rememberForever</code> para recuperar un elemento del caché o almacenarlo para siempre:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$value</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">rememberForever</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token constant">DB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="recuperar-y-eliminar"><a href="#recuperar-y-eliminar" aria-hidden="true" class="header-anchor">#</a> Recuperar Y Eliminar</h4> <p>Si necesitas recuperar un elemento del caché y después eliminarlo, puedes utilizar el método <code>pull</code>. Al igual que el método <code>get</code>, se devolverá <code>null</code> si el elemento no existe en la memoria caché:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$value</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">pull</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="storing-items-in-the-cache"></a></p> <h3 id="almacenar-elementos-en-cache"><a href="#almacenar-elementos-en-cache" aria-hidden="true" class="header-anchor">#</a> Almacenar Elementos En Caché</h3> <p>Puedes utilizar el método <code>put</code> en el facade <code>Cache</code> para almacenar elementos en caché:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'value'</span><span class="token punctuation">,</span> <span class="token variable">$seconds</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si el tiempo de almacenamiento no es pasado al método <code>put</code>, el elemento será almacenado indefinidamente:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>En lugar de pasar el número de segundos como un entero, también puedes pasar una instancia de <code>DateTime</code> que represente el tiempo de expiración del elemento almacenado en caché:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'value'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">addMinutes</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="almacenar-si-no-esta-presente"><a href="#almacenar-si-no-esta-presente" aria-hidden="true" class="header-anchor">#</a> Almacenar Si No Está Presente</h4> <p>El método <code>add</code> solo agregará el elemento a caché si éste no existe todavia en la memoria caché. El metodo va a regresar <code>true</code> si el elemento realmente se agregó a la caché. De otra manera, el método va a regresar <code>false</code>:</p> <pre><code>Cache::add('key', 'value', $seconds);
</code></pre> <h4 id="almacenar-elementos-para-siempre"><a href="#almacenar-elementos-para-siempre" aria-hidden="true" class="header-anchor">#</a> Almacenar Elementos Para Siempre</h4> <p>El método <code>forever</code> puede ser utilizado para almacenar un elemento en la memoria caché de manera permanente. Como estos elementos no caducan, se deben eliminar de la memoria caché manualmente utilizando el método <code>forget</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">forever</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Si utilizas el controlador de Memcached, los elementos almacenados &quot;permanentemente&quot; podrán ser eliminados una vez que la caché alcance su tamaño límite.</p></div> <p><a name="removing-items-from-the-cache"></a></p> <h3 id="eliminar-elementos-de-la-cache"><a href="#eliminar-elementos-de-la-cache" aria-hidden="true" class="header-anchor">#</a> Eliminar Elementos De La Caché</h3> <p>Puedes eliminar elementos de caché utilizando el método <code>forget</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">forget</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>También puedes eliminar elementos de caché especificando un TTL cero o negativo:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'value'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'value'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Puedes borrar todo el caché utilizando el método <code>flush</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="danger custom-block"><p class="custom-block-title">Nota</p> <p>La limpieza de caché no respeta el prefijo del caché y borrará todas las entradas del caché. Considera esto cuidadosamente cuando borres un caché que sea compartido por otras aplicaciones.</p></div> <p><a name="atomic-locks"></a></p> <h3 id="bloqueos-atomicos"><a href="#bloqueos-atomicos" aria-hidden="true" class="header-anchor">#</a> Bloqueos Atómicos</h3> <div class="danger custom-block"><p class="custom-block-title">Nota</p> <p>Para usar esta característica, tu aplicación debe estar haciendo uso de los drivers de caché <code>memcached</code>, <code>dynamodb</code>, o <code>redis</code> como el driver de caché por defecto de tu aplicación. Adicionalmente, todos los servidores deben estar comunicándose con el mismo servidor de caché central.</p></div> <p>Los bloqueos atómicos permiten la manipulación de bloqueos distribuidos sin que tengas que preocuparte sobre las condiciones de la carrera. Por ejemplo, <a href="https://forge.laravel.com" target="_blank" rel="noopener noreferrer">Laravel Forge<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> usa bloqueos atómicos para asegurarse de que sólo una tarea remota está siendo ejecutada en un servidor a la vez. Puedes crear y administrar bloqueos usando el método <code>Cache::lock</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Cache</span><span class="token punctuation">;</span>

<span class="token variable">$lock</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$lock</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Lock acquired for 10 seconds...</span>

    <span class="token variable">$lock</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>El método <code>get</code> también acepta una Closure. Luego de que la Closure sea ejecutada, Laravel automáticamente liberará el cierre:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Lock acquired indefinitely and automatically released...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si el bloqueo no está disponible en el momento en que lo solicitas, puedes instruir a Laravel para que espere un número determinado de segundos. Si el bloqueo no puede ser adquirido dentro del tiempo límite especificado, una excepción <code>Illuminate\Contracts\Cache\LockTimeoutException</code> será mostrada:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>LockTimeoutException</span><span class="token punctuation">;</span>

<span class="token variable">$lock</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token variable">$lock</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Lock acquired after waiting maximum of 5 seconds...</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">LockTimeoutException</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Unable to acquire lock...</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token function">optional</span><span class="token punctuation">(</span><span class="token variable">$lock</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Lock acquired after waiting maximum of 5 seconds...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="administrando-bloqueos-a-traves-de-procesos"><a href="#administrando-bloqueos-a-traves-de-procesos" aria-hidden="true" class="header-anchor">#</a> Administrando Bloqueos A Través de Procesos</h4> <p>Algunas veces, necesitarás adquirir un bloqueo en un proceso para liberarlo en otro proceso distinto más adelante. Por ejemplo, podemos solicitar un bloqueo durante la ejecución de un proceso que hace una solicitud web pero queremos liberarlo después que se ejecute un trabajo que es despachado donde se hizo la solicitud a una cola de trabajos. En un escenario como éste, necesitaríamos tomar la identificación del propietario del bloqueo (owner token) en el ámbito donde se produce el mismo y pasarlo al trabajo que va a la cola de trabajos de modo que pueda volver a instanciar el bloqueo usando ese identificador.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// Within Controller...</span>
<span class="token variable">$podcast</span> <span class="token operator">=</span> Podcast<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$lock</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$lock</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ProcessPodcast<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token variable">$podcast</span><span class="token punctuation">,</span> <span class="token variable">$lock</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">owner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Within ProcessPodcast Job...</span>
Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">restoreLock</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">owner</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si prefieres liberar un bloqueo sin necesidad de indicar su propietario, puedes usar el método <code>forceRelease</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">forceRelease</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="the-cache-helper"></a></p> <h3 id="el-helper-cache"><a href="#el-helper-cache" aria-hidden="true" class="header-anchor">#</a> El Helper Cache</h3> <p>Además de usar el facade <code>Cache</code> o <a href="/docs/%7B%7Bversion%7D%7D/contracts">la interfaz de caché</a>, también puedes usar la función global <code>cache</code> para recuperar y almacenar información a través del caché. Cuando se llama a la función <code>cache</code> con un solo argumento, devolverá el valor de la clave dada:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">cache</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si proporcionas un arreglo de pares clave / valor y su tiempo de expiración a la función, almacenará los valores en caché durante la duración especificada:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">cache</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'key'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$seconds</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">cache</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'key'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">addMinutes</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Cuando la función <code>cache</code> es llamada sin ningún argumento, ésta retorna una instancia de la implementación <code>Illuminate\Contracts\Cache\Factory</code>, permitiéndote llamar a otros métodos de almacenamiento en caché:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">remember</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">,</span> <span class="token variable">$seconds</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token constant">DB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Al realizar pruebas utilizando la función global <code>cache</code>, deberás usar el método <code>Cache::shouldReceive</code> como si estuvieras <a href="/docs/%7B%7Bversion%7D%7D/mocking#mocking-facades">probando un facade</a>.</p></div> <p><a name="cache-tags"></a></p> <h2 id="cache-tags"><a href="#cache-tags" aria-hidden="true" class="header-anchor">#</a> Cache Tags</h2> <div class="danger custom-block"><p class="custom-block-title">Nota</p> <p>Las etiquetas de caché no son compatibles cuando usas los controladores de caché <code>file</code> o <code>database</code>. Además, cuando se utilicen múltiples etiquetas con cachés que son almacenados &quot;permanentemente&quot;, el rendimiento será mejor si utilizas un controlador como <code>memcached</code>, el cual automaticamente purga los registros obsoletos.</p></div> <p><a name="storing-tagged-cache-items"></a></p> <h3 id="almacenar-elementos-de-cache-etiquetados"><a href="#almacenar-elementos-de-cache-etiquetados" aria-hidden="true" class="header-anchor">#</a> Almacenar Elementos De Caché Etiquetados</h3> <p>Las etiquetas de caché te permiten etiquetar elementos relacionados en caché y después limpiar todos los valores almacenados en caché asignados a una etiqueta dada. Puedes acceder a un caché etiquetado al pasar un arreglo ordenado de nombres de etiquetas. Por ejemplo, vamos a acceder a un caché etiquetado y al valor <code>put</code> en el caché:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tags</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'people'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'artists'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'John'</span><span class="token punctuation">,</span> <span class="token variable">$john</span><span class="token punctuation">,</span> <span class="token variable">$seconds</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tags</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'people'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'authors'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Anne'</span><span class="token punctuation">,</span> <span class="token variable">$anne</span><span class="token punctuation">,</span> <span class="token variable">$seconds</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="accessing-tagged-cache-items"></a></p> <h3 id="acceder-a-elementos-de-cache-etiquetados"><a href="#acceder-a-elementos-de-cache-etiquetados" aria-hidden="true" class="header-anchor">#</a> Acceder A Elementos De Caché Etiquetados</h3> <p>Para recuperar un elemento de caché etiquetado, pasa la misma lista ordenada de etiquetas al método <code>tags</code> y después haz un llamado al método <code>get</code> con la clave que deseas recuperar:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$john</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tags</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'people'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'artists'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'John'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$anne</span> <span class="token operator">=</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tags</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'people'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'authors'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Anne'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="removing-tagged-cache-items"></a></p> <h3 id="eliminar-elementos-de-cache-etiquetados"><a href="#eliminar-elementos-de-cache-etiquetados" aria-hidden="true" class="header-anchor">#</a> Eliminar Elementos De Caché Etiquetados</h3> <p>Puedes borrar todos los elementos a los que se les asigna una etiqueta o lista de etiquetas. Por ejemplo, la siguiente sentencia eliminaría todos los cachés etiquetados tanto con <code>people</code>, <code>authors</code> o ambos. Por lo tanto, tanto <code>Anne</code> como <code>John</code> serán eliminados de caché:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tags</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'people'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'authors'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Por el contrario, la siguiente sentencia eliminará solamente los cachés con la etiqueta <code>authors</code>, por lo tanto se eliminará <code>Anne</code>, pero <code>John</code> no:</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tags</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'authors'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="adding-custom-cache-drivers"></a></p> <h2 id="agregar-controladores-de-cache-personalizados"><a href="#agregar-controladores-de-cache-personalizados" aria-hidden="true" class="header-anchor">#</a> Agregar Controladores De Caché Personalizados</h2> <p><a name="writing-the-driver"></a></p> <h3 id="escribir-el-controlador"><a href="#escribir-el-controlador" aria-hidden="true" class="header-anchor">#</a> Escribir El Controlador</h3> <p>Para crear el controlador de caché, primero se debe implementar la <a href="/docs/%7B%7Bversion%7D%7D/contracts">interfaz</a> <code>Illuminate\Contracts\Cache\Store</code>. Por lo tanto, una implementación de caché de MongoDB se vería de la siguiente manera:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Extensions</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>Store</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MongoStore</span> <span class="token keyword">implements</span> <span class="token class-name">Store</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">many</span><span class="token punctuation">(</span><span class="token keyword">array</span> <span class="token variable">$keys</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$seconds</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">putMany</span><span class="token punctuation">(</span><span class="token keyword">array</span> <span class="token variable">$values</span><span class="token punctuation">,</span> <span class="token variable">$seconds</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">forever</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">forget</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getPrefix</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Solo necesitas implementar cada uno de estos métodos utilizando una conexión de MongoDB. Para tener un ejemplo de cómo implementar cada uno de estos métodos, puedes echar un vistazo a <code>Illuminate\Cache\MemcachedStore</code> en el código fuente del framework. Una vez que completes la implementación, puedes finalizar con el registro de tu controlador personalizado.</p> <div class="language-php extra-class"><pre class="language-php"><code>Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mongo'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">repository</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MongoStore</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Si te preguntas dónde puedes colocar el código de tu driver de caché personalizado, puedes crear un espacio de nombre <code>Extensions</code> en tu directorio <code>app</code>. Sin embargo, ten en cuenta que Laravel no tiene una estructura de aplicación rígida y por tanto eres libre de organizar tu aplicación de acuerdo a tus preferencias.</p></div> <p><a name="registering-the-driver"></a></p> <h3 id="registrando-el-driver"><a href="#registrando-el-driver" aria-hidden="true" class="header-anchor">#</a> Registrando El Driver</h3> <p>Para registrar el controlador de caché personalizado con Laravel, debes utilizar el método <code>extend</code> en el facade <code>Cache</code>. La llamada a <code>Cache::extend</code> puede hacerse en el método <code>boot</code> del <code>App\Providers\AppServiceProvider</code> predeterminado que contiene cada aplicación nueva de Laravel, o puedes crear tu propio proveedor de servicios para alojar la extensión - solo recuerda registrar el proveedor en el arreglo de proveedores en <code>config/app.php</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Providers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Extensions<span class="token punctuation">\</span>MongoStore</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Cache</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>ServiceProvider</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">CacheServiceProvider</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceProvider</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Perform post-registration booting of services.
    *
    * @return void
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mongo'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> Cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">repository</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MongoStore</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * Register bindings in the container.
    *
    * @return void
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>El primer argumento pasado al método <code>extend</code> es el nombre del controlador. Esto corresponde a la opción <code>driver</code> en el archivo de configuración <code>config/cache.php</code>. El segundo argumento es un Closure que debe regresar una instancia de <code>Illuminate\Cache\Repository</code>. El Closure debe pasar una instancia de <code>$app</code>, que es una instancia del <a href="/docs/%7B%7Bversion%7D%7D/container">contenedor de servicios</a>.</p> <p>Una vez que hayas registrado tu extensión, actualiza la opción <code>driver</code> en tu archivo de configuración <code>config/cache.php</code> con el nombre de tu extensión.</p> <p><a name="events"></a></p> <h2 id="eventos"><a href="#eventos" aria-hidden="true" class="header-anchor">#</a> Eventos</h2> <p>Para ejecutar código en cada operación de caché, puedes escuchar los <a href="/docs/%7B%7Bversion%7D%7D/events">eventos</a> activados por el caché. Normalmente, debes colocar estos listener de eventos dentro de tu <code>EventServiceProvider</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* The event listener mappings for the application.
*
* @var array
*/</span>
<span class="token keyword">protected</span> <span class="token variable">$listen</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'Illuminate\Cache\Events\CacheHit'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'App\Listeners\LogCacheHit'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'Illuminate\Cache\Events\CacheMissed'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'App\Listeners\LogCacheMissed'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'Illuminate\Cache\Events\KeyForgotten'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'App\Listeners\LogKeyForgotten'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'Illuminate\Cache\Events\KeyWritten'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'App\Listeners\LogKeyWritten'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/broadcasting.html" class="prev">
          Broadcasting
        </a></span> <span class="next"><a href="/collections.html">
          Collecciones
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.bf22240a.js" defer></script><script src="/assets/js/15.abc982c9.js" defer></script>
  </body>
</html>
