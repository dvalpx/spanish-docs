(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{254:function(a,s,t){"use strict";t.r(s);var e=t(0),n=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"content"},[t("div",{pre:!0},[t("h1",{pre:!0,attrs:{id:"bases-de-datos-primeros-pasos"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#bases-de-datos-primeros-pasos","aria-hidden":"true"}},[a._v("#")]),a._v(" Bases de Datos: Primeros Pasos")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#introduction"}},[a._v("Introducción")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#configuration"}},[a._v("Configuración")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#read-and-write-connections"}},[a._v("Conexiones de Lectura & Escritura")])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#using-multiple-database-connections"}},[a._v("Usando Múltiples Conexiones de Bases de Datos")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#running-queries"}},[a._v("Ejecutando Consultas SQL Nativas")]),a._v(" "),t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#listening-for-query-events"}},[a._v("Listeners de Eventos de Consultas")])])])]),a._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#database-transactions"}},[a._v("Transacciones de Bases de Datos")])])]),a._v(" "),t("p",[t("a",{pre:!0,attrs:{name:"introduction"}})]),a._v(" "),t("h2",{pre:!0,attrs:{id:"introduccion"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#introduccion","aria-hidden":"true"}},[a._v("#")]),a._v(" Introducción")]),a._v(" "),t("p",[a._v("Laravel hace que la interacción con las bases de datos sea extremadamente fácil a través de una variedad de backends de bases de datos usando SQL nativo, el constructor de consultas "),t("a",{pre:!0,attrs:{href:"/docs/%7B%7Bversion%7D%7D/queries"}},[a._v("query builder")]),a._v(" y el "),t("a",{pre:!0,attrs:{href:"/docs/%7B%7Bversion%7D%7D/eloquent"}},[a._v("ORM Eloquent")]),a._v(". Actualmente, Laravel soporta cuatro bases de datos.")]),a._v(" "),t("ul",[t("li",[a._v("MySQL")]),a._v(" "),t("li",[a._v("PostgreSQL")]),a._v(" "),t("li",[a._v("SQLite")]),a._v(" "),t("li",[a._v("SQL Server")])]),a._v(" "),t("p",[t("a",{pre:!0,attrs:{name:"configuration"}})]),a._v(" "),t("h3",{pre:!0,attrs:{id:"configuracion"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#configuracion","aria-hidden":"true"}},[a._v("#")]),a._v(" Configuración")]),a._v(" "),t("p",[a._v("La configuración de base de datos para tu aplicación está localizada en "),t("code",[a._v("config/database.php")]),a._v(". Puedes definir todo lo concerniente a tus conexiones de bases de datos, y también especificar qué conexión debería ser usada por defecto. Ejemplos para la mayoría de los sistemas de bases de datos soportados son proporcionados en este archivo.")]),a._v(" "),t("p",[a._v("Por defecto, la "),t("a",{pre:!0,attrs:{href:"/docs/%7B%7Bversion%7D%7D/configuration#environment-configuration"}},[a._v("configuración de entorno")]),a._v(" de muestra de Laravel está lista para usar con "),t("a",{pre:!0,attrs:{href:"/docs/%7B%7Bversion%7D%7D/homestead"}},[a._v("Laravel Homestead")]),a._v(", la cual es una máquina virtual conveniente para el desarrollo con Laravel en tu máquina local. Eres libre de modificar esta configuración de acuerdo a tus necesidades de tu base de datos local.")]),a._v(" "),t("h4",{pre:!0,attrs:{id:"configuracion-sqlite"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#configuracion-sqlite","aria-hidden":"true"}},[a._v("#")]),a._v(" Configuración SQLite")]),a._v(" "),t("p",[a._v("Después de la creación de una nueva base de datos SQLite usando un comando tal como "),t("code",[a._v("touch database/database.sqlite")]),a._v(", puedes configurar fácilmente tus variables de entorno para apuntar a esta base de datos creada recientemente al usar la ruta absoluta a la base de datos.")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB_CONNECTION")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("sqlite\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB_DATABASE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("absolute"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("path"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("to"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("database"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sqlite\n")])])]),t("p",[a._v("Para habilitar las claves foráneas en conexiones de SQLite, debes agregar la opción "),t("code",[a._v("foreign_key_constraints")]),a._v(" en tu archivo de configuración "),t("code",[a._v("config/database.php")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'sqlite'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// ...")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'foreign_key_constraints'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n")])])]),t("p",[t("a",{pre:!0,attrs:{name:"read-and-write-connections"}})]),a._v(" "),t("h3",{pre:!0,attrs:{id:"conexiones-de-lectura-escritura"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#conexiones-de-lectura-escritura","aria-hidden":"true"}},[a._v("#")]),a._v(" Conexiones de Lectura & Escritura")]),a._v(" "),t("p",[a._v("Algunas veces puedes desear contar con una conexión de base de datos para los comandos SELECT y otra para los comandos UPDATE y DELETE. Laravel hace esto una tarea fácil, y las conexiones propias siempre serán usadas si estás usando consultas nativas, el constructor de consultas Query Builder o el ORM Eloquent.")]),a._v(" "),t("p",[a._v("Para ver cómo las conexiones de lectura / escritura deberían ser configuradas, vamos a mirar este ejemplo:")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'mysql'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'read'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'host'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'192.168.1.1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'write'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'host'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'196.168.1.2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'sticky'")]),a._v("    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'driver'")]),a._v("    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'mysql'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'database'")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'database'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'username'")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'root'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'password'")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'charset'")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'utf8mb4'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'collation'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'utf8mb4_unicode_ci'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'prefix'")]),a._v("    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n")])])]),t("p",[a._v("Observa que tres claves han sido agregadas al arreglo de configuración: "),t("code",[a._v("read")]),a._v(", "),t("code",[a._v("write")]),a._v(" y "),t("code",[a._v("sticky")]),a._v(". Las claves "),t("code",[a._v("read")]),a._v(" y "),t("code",[a._v("write")]),a._v(" tienen valores de arreglo conteniendo una sola clave: la dirección ip del "),t("code",[a._v("host")]),a._v(". El resto de las opciones de la base de datos para las conexiones "),t("code",[a._v("read")]),a._v(" y "),t("code",[a._v("write")]),a._v(" serán tomadas del arreglo principal "),t("code",[a._v("mysql")]),a._v(".")]),a._v(" "),t("p",[a._v("Únicamente necesitas colocar elementos en los arreglos "),t("code",[a._v("read")]),a._v(" y "),t("code",[a._v("write")]),a._v(" si deseas sobreescribir los valores del arreglo principal. Así, en este caso, "),t("code",[a._v("192.168.1.1")]),a._v(' será usado como la máquina para la conexión de "lectura", mientras que '),t("code",[a._v("192.168.1.2")]),a._v(' será usada para la conexión de "escritura".  Las credenciales de bases de datos, prefijo, conjunto de caracteres, y todas las demás opciones en el arreglo principal '),t("code",[a._v("mysql")]),a._v(" serán compartidas a través de ambas conexiones.")]),a._v(" "),t("h4",{pre:!0,attrs:{id:"la-opcion-sticky"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#la-opcion-sticky","aria-hidden":"true"}},[a._v("#")]),a._v(" La Opción "),t("code",[a._v("sticky")])]),a._v(" "),t("p",[a._v("La opción "),t("code",[a._v("sticky")]),a._v(" es un valor "),t("em",[a._v("opcional")]),a._v(" que puede ser usado para permitir la lectura inmediata de registros que han sido escritos a la base de datos durante el ciclo de solicitudes actual. Si la opción "),t("code",[a._v("sticky")]),a._v(' está habilitada y una operación de "escritura" ha sido ejecutada contra la base de datos durante el ciclo de solicitudes actual, cualquiera de las operaciones de "lectura" hasta aquí usarán la conexión "write". Esto asegura que cualquier dato escrito durante el ciclo de solicitud pueda ser leído inmediatamente de la base de datos durante la misma solicitud. Es posible para ti decidir si este es el comportamiento deseado para tu aplicación.')]),a._v(" "),t("p",[t("a",{pre:!0,attrs:{name:"using-multiple-database-connections"}})]),a._v(" "),t("h3",{pre:!0,attrs:{id:"usando-conexiones-de-bases-de-datos-multiples"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#usando-conexiones-de-bases-de-datos-multiples","aria-hidden":"true"}},[a._v("#")]),a._v(" Usando Conexiones de Bases de Datos Múltiples")]),a._v(" "),t("p",[a._v("Cuando estamos usando conexiones múltiples, puedes acceder a cada conexión por medio del método "),t("code",[a._v("connection")]),a._v(" en el Facade "),t("code",[a._v("DB")]),a._v(".  El nombre "),t("code",[a._v("name")]),a._v(" pasado al método de conexión "),t("code",[a._v("connection")]),a._v(" debería corresponder a una de las conexiones listadas en tu archivo de configuración "),t("code",[a._v("config/database.php")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$users")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("connection")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'foo'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("select")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("También puedes acceder a los datos nativos de la instancia PDO subyacente que usa el método "),t("code",[a._v("getPdo")]),a._v(" en una instancia de conexión:")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$pdo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("connection")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getPdo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{pre:!0,attrs:{name:"running-queries"}})]),a._v(" "),t("h2",{pre:!0,attrs:{id:"ejecutando-consultas-sql-nativas"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#ejecutando-consultas-sql-nativas","aria-hidden":"true"}},[a._v("#")]),a._v(" Ejecutando Consultas SQL Nativas")]),a._v(" "),t("p",[a._v("Una vez que has configurado tu conexión de base de datos, puedes ejecutar consultas usando el Facade "),t("code",[a._v("DB")]),a._v(". La clase facade "),t("code",[a._v("DB")]),a._v(" proporciona métodos para cada tipo de consulta: "),t("code",[a._v("select")]),a._v(", "),t("code",[a._v("update")]),a._v(", "),t("code",[a._v("insert")]),a._v(", "),t("code",[a._v("delete")]),a._v(" y "),t("code",[a._v("statement")]),a._v(".")]),a._v(" "),t("h4",{pre:!0,attrs:{id:"ejecutando-una-consulta-select"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#ejecutando-una-consulta-select","aria-hidden":"true"}},[a._v("#")]),a._v(" Ejecutando una consulta Select")]),a._v(" "),t("p",[a._v("Para ejecutar una consulta básica, puedes usar el método "),t("code",[a._v("select")]),a._v(" en el facade "),t("code",[a._v("DB")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token php language-php"}},[t("span",{pre:!0,attrs:{class:"token delimiter important"}},[a._v("<?php")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("namespace")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Controllers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Support"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Facades"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Controllers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Controller")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("UserController")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("extends")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Controller")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n    * Muestra una lista de todos los usuarios de la aplicación.\n    *\n    * @return Response\n    */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("index")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$users")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("select")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'select * from users where active = ?'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("view")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'user.index'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'users'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$users")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])])]),t("p",[a._v("El primer argumento pasado al método "),t("code",[a._v("select")]),a._v(" es la consulta SQL nativa; en este caso está parametrizada, mientras el segundo argumento es cualquier parámetro a enlazar que necesita estar conectado a la consulta. Típicamente, estos son los valores de las restricciones de cláusula "),t("code",[a._v("where")]),a._v(". El enlazamiento de parámetro proporciona protección contra ataques de inyección SQL.")]),a._v(" "),t("p",[a._v("El método "),t("code",[a._v("select")]),a._v(" siempre devolverá un arreglo de resultados. Cada resultado dentro del arreglo será un objeto "),t("code",[a._v("stdClass")]),a._v(" de PHP, permitiendo que accedas a los valores de los resultados:")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("foreach")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$users")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("as")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("h4",{pre:!0,attrs:{id:"usando-enlaces-nombrados"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#usando-enlaces-nombrados","aria-hidden":"true"}},[a._v("#")]),a._v(" Usando Enlaces Nombrados")]),a._v(" "),t("p",[a._v("En lugar de usar "),t("code",[a._v("?")]),a._v(" para representar tus enlaces (bindings) de parámetros, puedes ejecutar una consulta usando enlaces nombrados:")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$results")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("select")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'select * from users where id = :id'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'id'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{pre:!0,attrs:{id:"ejecutando-una-instruccion-insert"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#ejecutando-una-instruccion-insert","aria-hidden":"true"}},[a._v("#")]),a._v(" Ejecutando una Instrucción Insert")]),a._v(" "),t("p",[a._v("Para ejecutar una instrucción "),t("code",[a._v("insert")]),a._v(", puedes usar el método "),t("code",[a._v("insert")]),a._v(" en la clase facade "),t("code",[a._v("DB")]),a._v(". Igual que "),t("code",[a._v("select")]),a._v(", este método toma la consulta SQL nativa como su argumento inicial y lo enlaza con su argumento secundario:")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("insert")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'insert into users (id, name) values (?, ?)'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'Dayle'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{pre:!0,attrs:{id:"ejecutando-una-instruccion-update"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#ejecutando-una-instruccion-update","aria-hidden":"true"}},[a._v("#")]),a._v(" Ejecutando una Instrucción Update")]),a._v(" "),t("p",[a._v("El método "),t("code",[a._v("update")]),a._v(" debería ser usado para actualizar los registros existentes en la base de datos. El número de filas afectadas por la instrucción serán devueltas:")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$affected")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'update users set votes = 100 where name = ?'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'John'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{pre:!0,attrs:{id:"ejecutando-una-instruccion-delete"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#ejecutando-una-instruccion-delete","aria-hidden":"true"}},[a._v("#")]),a._v(" Ejecutando una Instrucción Delete")]),a._v(" "),t("p",[a._v("El método "),t("code",[a._v("delete")]),a._v(" debería ser usado para eliminar registros de la base de datos. Al igual que "),t("code",[a._v("update")]),a._v(", el número de filas afectadas será devuelto:")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$deleted")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("delete")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'delete from users'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{pre:!0,attrs:{id:"ejecutando-una-instruccion-general"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#ejecutando-una-instruccion-general","aria-hidden":"true"}},[a._v("#")]),a._v(" Ejecutando una Instrucción General")]),a._v(" "),t("p",[a._v("Algunas instrucciones de bases de datos no devuelven algún valor. Para estos tipos de operaciones, puedes usar el método "),t("code",[a._v("statement")]),a._v(" en la clase facade "),t("code",[a._v("DB")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("statement")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'drop table users'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[t("a",{pre:!0,attrs:{name:"listening-for-query-events"}})]),a._v(" "),t("h3",{pre:!0,attrs:{id:"listeners-de-eventos-de-consultas"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#listeners-de-eventos-de-consultas","aria-hidden":"true"}},[a._v("#")]),a._v(" Listeners de Eventos de Consultas")]),a._v(" "),t("p",[a._v("Si prefieres recibir cada consulta SQL ejecutada por tu aplicación, puedes usar el método "),t("code",[a._v("listen")]),a._v(". Este método es útil para registrar consultas o depurar. Puedes registrar tus listeners de consultas en un "),t("a",{pre:!0,attrs:{href:"/docs/%7B%7Bversion%7D%7D/providers"}},[a._v("proveedor de servicio")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token php language-php"}},[t("span",{pre:!0,attrs:{class:"token delimiter important"}},[a._v("<?php")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("namespace")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Providers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Support"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Facades"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token package"}},[a._v("Illuminate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Support"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("ServiceProvider")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AppServiceProvider")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("extends")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ServiceProvider")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n    * Inicializa cualquiera de los servicios de la aplicación.\n    *\n    * @return void\n    */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("boot")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$query")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// $query->sql")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// $query->bindings")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// $query->time")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n    * Registra el proveedor de servicio.\n    *\n    * @return void\n    */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("register")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])])]),t("p",[t("a",{pre:!0,attrs:{name:"database-transactions"}})]),a._v(" "),t("h2",{pre:!0,attrs:{id:"transacciones-de-bases-de-datos"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#transacciones-de-bases-de-datos","aria-hidden":"true"}},[a._v("#")]),a._v(" Transacciones de Bases de Datos")]),a._v(" "),t("p",[a._v("Puedes usar el método "),t("code",[a._v("transaction")]),a._v(" en la clase facade "),t("code",[a._v("DB")]),a._v(" para ejecutar un conjunto de operaciones dentro de una transacción de base de datos. Si un error de excepción es arrojado dentro del código "),t("code",[a._v("Closure")]),a._v(" de la transacción, la transacción automáticamente terminará con un rollback. Si el código "),t("code",[a._v("Closure")]),a._v(" se ejecuta correctamente, la transacción terminará automáticamente con un commit. No necesitas preocuparte por hacer rollback o commit manualmente mientras estés usando el método "),t("code",[a._v("transaction")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("transaction")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("table")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'users'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'votes'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("table")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'posts'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("delete")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{pre:!0,attrs:{id:"manejando-deadlocks-bloqueo-mutuo"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#manejando-deadlocks-bloqueo-mutuo","aria-hidden":"true"}},[a._v("#")]),a._v(" Manejando Deadlocks (Bloqueo mutuo)")]),a._v(" "),t("p",[a._v("El método "),t("code",[a._v("transaction")]),a._v(" acepta un segundo argumento opcional el cual define el número de veces que la ejecución de una transacción debería ser reintentada cuando un ocurra un deadlock. Una vez que estos intentos hayan sido completados sin éxito, un error de excepción será arrojado:")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("transaction")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("table")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'users'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'votes'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("table")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[a._v("'posts'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("delete")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h4",{pre:!0,attrs:{id:"usando-transacciones-manualmente"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#usando-transacciones-manualmente","aria-hidden":"true"}},[a._v("#")]),a._v(" Usando Transacciones Manualmente")]),a._v(" "),t("p",[a._v("Si prefieres empezar una transacción manualmente y tener control total sobre rollbacks y commits, podrías usar el método "),t("code",[a._v("beginTransaction")]),a._v(" de la clase facade "),t("code",[a._v("DB")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("beginTransaction")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Puedes hacer rollback de la transacción por medio del método "),t("code",[a._v("rollback")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("rollBack")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("Finalmente, puedes confirmar una transacción por medio del método "),t("code",[a._v("commit")]),a._v(":")]),a._v(" "),t("div",{pre:!0,attrs:{class:"language-php extra-class"}},[t("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("DB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("commit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("div",{pre:!0,attrs:{class:"tip custom-block"}},[t("p",{pre:!0,attrs:{class:"custom-block-title"}},[a._v("TIP")]),a._v(" "),t("p",[a._v("Los métodos de transacción del Facade "),t("code",[a._v("DB")]),a._v(" controlan las transacciones para ambos backends de bases de datos del constructor de consultas "),t("a",{pre:!0,attrs:{href:"/docs/%7B%7Bversion%7D%7D/queries"}},[a._v("query builder")]),a._v(" y el "),t("a",{pre:!0,attrs:{href:"/docs/%7B%7Bversion%7D%7D/eloquent"}},[a._v("ORM Eloquent")]),a._v(".")])])])])}],!1,null,null,null);s.default=n.exports}}]);