<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Notificaciones | Documentación de Laravel en Español</title>
    <meta name="description" content="Documentación de Laravel en Español">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Catamaran:300,700|Miriam+Libre">
    
    <link rel="preload" href="/assets/css/0.styles.0cc2d3c3.css" as="style"><link rel="preload" href="/assets/js/app.bf22240a.js" as="script"><link rel="preload" href="/assets/js/53.0a9d4aed.js" as="script"><link rel="prefetch" href="/assets/js/10.8a8a99df.js"><link rel="prefetch" href="/assets/js/11.ec476e2f.js"><link rel="prefetch" href="/assets/js/12.6db1eb13.js"><link rel="prefetch" href="/assets/js/13.92d78bb5.js"><link rel="prefetch" href="/assets/js/14.1a0ad5f1.js"><link rel="prefetch" href="/assets/js/15.abc982c9.js"><link rel="prefetch" href="/assets/js/16.7cf1a759.js"><link rel="prefetch" href="/assets/js/17.4abfc664.js"><link rel="prefetch" href="/assets/js/18.85b19837.js"><link rel="prefetch" href="/assets/js/19.8c9dfcd5.js"><link rel="prefetch" href="/assets/js/2.dcb6cf45.js"><link rel="prefetch" href="/assets/js/20.c1b9de54.js"><link rel="prefetch" href="/assets/js/21.469ffab3.js"><link rel="prefetch" href="/assets/js/22.2d14e150.js"><link rel="prefetch" href="/assets/js/23.7a4dcc9a.js"><link rel="prefetch" href="/assets/js/24.534e59f1.js"><link rel="prefetch" href="/assets/js/25.eaac1c07.js"><link rel="prefetch" href="/assets/js/26.8e9180e0.js"><link rel="prefetch" href="/assets/js/27.2cd2ace8.js"><link rel="prefetch" href="/assets/js/28.9f7dcf6d.js"><link rel="prefetch" href="/assets/js/29.06a87f0d.js"><link rel="prefetch" href="/assets/js/3.b62bf0b4.js"><link rel="prefetch" href="/assets/js/30.b03f86ec.js"><link rel="prefetch" href="/assets/js/31.edce81f6.js"><link rel="prefetch" href="/assets/js/32.6657300b.js"><link rel="prefetch" href="/assets/js/33.8dc49209.js"><link rel="prefetch" href="/assets/js/34.03cbee56.js"><link rel="prefetch" href="/assets/js/35.5439db2e.js"><link rel="prefetch" href="/assets/js/36.83d5a264.js"><link rel="prefetch" href="/assets/js/37.4066824e.js"><link rel="prefetch" href="/assets/js/38.c3fe05aa.js"><link rel="prefetch" href="/assets/js/39.52ef8667.js"><link rel="prefetch" href="/assets/js/4.bd0ebba2.js"><link rel="prefetch" href="/assets/js/40.2c54d702.js"><link rel="prefetch" href="/assets/js/41.775bc6e1.js"><link rel="prefetch" href="/assets/js/42.6541d60b.js"><link rel="prefetch" href="/assets/js/43.20091aea.js"><link rel="prefetch" href="/assets/js/44.75b71ccc.js"><link rel="prefetch" href="/assets/js/45.6b36a3a8.js"><link rel="prefetch" href="/assets/js/46.6ea236af.js"><link rel="prefetch" href="/assets/js/47.0e0ee374.js"><link rel="prefetch" href="/assets/js/48.b6beb9b8.js"><link rel="prefetch" href="/assets/js/49.ae33b521.js"><link rel="prefetch" href="/assets/js/5.2c350d8b.js"><link rel="prefetch" href="/assets/js/50.5cb081e0.js"><link rel="prefetch" href="/assets/js/51.3e0281e2.js"><link rel="prefetch" href="/assets/js/52.e1fae1d6.js"><link rel="prefetch" href="/assets/js/54.55bc9113.js"><link rel="prefetch" href="/assets/js/55.e964fdb4.js"><link rel="prefetch" href="/assets/js/56.3abed8a0.js"><link rel="prefetch" href="/assets/js/57.df09269b.js"><link rel="prefetch" href="/assets/js/58.3ce37458.js"><link rel="prefetch" href="/assets/js/59.7a840aeb.js"><link rel="prefetch" href="/assets/js/6.6fce793d.js"><link rel="prefetch" href="/assets/js/60.b4fe788b.js"><link rel="prefetch" href="/assets/js/61.e45356bb.js"><link rel="prefetch" href="/assets/js/62.0d75cf78.js"><link rel="prefetch" href="/assets/js/63.0ecae205.js"><link rel="prefetch" href="/assets/js/64.90fb2c2d.js"><link rel="prefetch" href="/assets/js/65.7c476002.js"><link rel="prefetch" href="/assets/js/66.802dee8b.js"><link rel="prefetch" href="/assets/js/67.ae965c66.js"><link rel="prefetch" href="/assets/js/68.220c04d8.js"><link rel="prefetch" href="/assets/js/69.bf607b92.js"><link rel="prefetch" href="/assets/js/7.b956f78c.js"><link rel="prefetch" href="/assets/js/70.dea3d878.js"><link rel="prefetch" href="/assets/js/71.1f786e34.js"><link rel="prefetch" href="/assets/js/72.4bd65b39.js"><link rel="prefetch" href="/assets/js/73.414b29bd.js"><link rel="prefetch" href="/assets/js/74.b5ab4f13.js"><link rel="prefetch" href="/assets/js/75.f12fbb27.js"><link rel="prefetch" href="/assets/js/76.a140d22b.js"><link rel="prefetch" href="/assets/js/77.2595933c.js"><link rel="prefetch" href="/assets/js/78.46bb4eff.js"><link rel="prefetch" href="/assets/js/79.c549a0e3.js"><link rel="prefetch" href="/assets/js/8.3be12d8d.js"><link rel="prefetch" href="/assets/js/80.1b9cd731.js"><link rel="prefetch" href="/assets/js/81.6aa05825.js"><link rel="prefetch" href="/assets/js/9.60a01cba.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0cc2d3c3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Documentación de Laravel en Español</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Inicio</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Inicio</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Primeros Pasos</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Conceptos De Arquitectura</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Fundamentos</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Frontend</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Seguridad</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Profundizando</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/artisan.html" class="sidebar-link">Consola Artisan</a></li><li><a href="/broadcasting.html" class="sidebar-link">Broadcasting</a></li><li><a href="/cache.html" class="sidebar-link">Caché</a></li><li><a href="/collections.html" class="sidebar-link">Collecciones</a></li><li><a href="/events.html" class="sidebar-link">Eventos</a></li><li><a href="/filesystem.html" class="sidebar-link">Almacenamiento De Archivos</a></li><li><a href="/helpers.html" class="sidebar-link">Helpers</a></li><li><a href="/mail.html" class="sidebar-link">Correos Electrónicos</a></li><li><a href="/notifications.html" class="active sidebar-link">Notificaciones</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notifications.html#introduccion" class="sidebar-link">Introducción</a></li><li class="sidebar-sub-header"><a href="/notifications.html#crear-notificaciones" class="sidebar-link">Crear Notificaciones</a></li><li class="sidebar-sub-header"><a href="/notifications.html#enviar-notificaciones" class="sidebar-link">Enviar Notificaciones</a></li><li class="sidebar-sub-header"><a href="/notifications.html#notificaciones-por-correo" class="sidebar-link">Notificaciones Por Correo</a></li><li class="sidebar-sub-header"><a href="/notifications.html#notificaciones-por-correo-markdown" class="sidebar-link">Notificaciones Por Correo Markdown</a></li><li class="sidebar-sub-header"><a href="/notifications.html#notificaciones-de-base-de-datos" class="sidebar-link">Notificaciones De Base De Datos</a></li><li class="sidebar-sub-header"><a href="/notifications.html#notificaciones-de-difusion" class="sidebar-link">Notificaciones de Difusión</a></li><li class="sidebar-sub-header"><a href="/notifications.html#notificaciones-por-sms" class="sidebar-link">Notificaciones Por SMS</a></li><li class="sidebar-sub-header"><a href="/notifications.html#notificaciones-por-slack" class="sidebar-link">Notificaciones Por Slack</a></li><li class="sidebar-sub-header"><a href="/notifications.html#configuracion-regional-de-notificaciones" class="sidebar-link">Configuración Regional De Notificaciones</a></li><li class="sidebar-sub-header"><a href="/notifications.html#eventos-de-notificacion" class="sidebar-link">Eventos De Notificación</a></li><li class="sidebar-sub-header"><a href="/notifications.html#canales-personalizados" class="sidebar-link">Canales Personalizados</a></li></ul></li><li><a href="/packages.html" class="sidebar-link">Desarrollo de Paquetes</a></li><li><a href="/queues.html" class="sidebar-link">Colas De Trabajo</a></li><li><a href="/scheduling.html" class="sidebar-link">Programación de tareas</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Bases De Datos</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ORM Eloquent</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Pruebas</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Paquetes oficiales</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><div><h1 id="notificaciones"><a class="header-anchor" href="#notificaciones" aria-hidden="true">#</a> Notificaciones</h1> <ul><li><a href="#introduction">Introducción</a></li> <li><a href="#creating-notifications">Crear Notificaciones</a></li> <li><a href="#sending-notifications">Enviar Notificaciones</a> <ul><li><a href="#using-the-notifiable-trait">Utilizar El Atributo Notifiable</a></li> <li><a href="#using-the-notification-facade">Utilizar La Facade Notification</a></li> <li><a href="#specifying-delivery-channels">Especificar Canales De Entrega</a></li> <li><a href="#queueing-notifications">Notificaciones En Cola</a></li> <li><a href="#on-demand-notifications">Notificaciones Bajo Demanda</a></li></ul></li> <li><a href="#mail-notifications">Notificaciones Por Correo</a> <ul><li><a href="#formatting-mail-messages">Formato Para Mensajes Por Correo</a></li> <li><a href="#customizing-the-sender">Personalizar El Remitente</a></li> <li><a href="#customizing-the-recipient">Personalizar El Destinatario</a></li> <li><a href="#customizing-the-subject">Personalizar El Asunto</a></li> <li><a href="#customizing-the-templates">Personalizar Las Plantillas</a></li> <li><a href="#previewing-mail-notifications">Previsualizar Notificaciones De Correo</a></li></ul></li> <li><a href="#markdown-mail-notifications">Notificaciones Por Correo En Markdown</a> <ul><li><a href="#generating-the-message">Generar El Mensaje</a></li> <li><a href="#writing-the-message">Escribir El Mensaje</a></li> <li><a href="#customizing-the-components">Personalizar Los Componentes</a></li></ul></li> <li><a href="#database-notifications">Notificaciones De La Base De Datos</a> <ul><li><a href="#database-prerequisites">Prerrequisitos</a></li> <li><a href="#formatting-database-notifications">Formato De Notificaciones De Base De Datos</a></li> <li><a href="#accessing-the-notifications">Acceder A Las Notificaciones</a></li> <li><a href="#marking-notifications-as-read">Marcar Notificaciones Como Leídas</a></li></ul></li> <li><a href="#broadcast-notifications">Notificaciones De Difusión</a> <ul><li><a href="#broadcast-prerequisites">Prerrequisitos</a></li> <li><a href="#formatting-broadcast-notifications">Formato De Notificaciones De Difusión</a></li> <li><a href="#listening-for-notifications">Escuchar Notificaciones</a></li></ul></li> <li><a href="#sms-notifications">Notificaciones Por SMS</a> <ul><li><a href="#sms-prerequisites">Prerrequisitos</a></li> <li><a href="#formatting-sms-notifications">Formato De Notificaciones Por SMS</a></li> <li><a href="#customizing-the-from-number">Personalizar El Número Remitente</a></li> <li><a href="#routing-sms-notifications">Enrutar Notificaciones Por SMS</a></li></ul></li> <li><a href="#slack-notifications">Notificaciones Por Slack</a> <ul><li><a href="#slack-prerequisites">Prerrequisitos</a></li> <li><a href="#formatting-slack-notifications">Formato De Notificaciones Por Slack</a></li> <li><a href="#slack-attachments">Archivos Adjuntos En Slack</a></li> <li><a href="#routing-slack-notifications">Enrutar Notificaciones Por Slack</a></li></ul></li> <li><a href="#localizing-notifications">Configuración Regional De Notificaciones</a></li> <li><a href="#notification-events">Eventos De Notificación</a></li> <li><a href="#custom-channels">Canales Personalizados</a></li></ul> <p><a name="introduction"></a></p> <h2 id="introduccion"><a class="header-anchor" href="#introduccion" aria-hidden="true">#</a> Introducción</h2> <p>Además de soporte para <a href="/docs/%7B%7Bversion%7D%7D/mail">enviar correos electrónicos</a>, Laravel brinda soporte para el envío de notificaciones mediante una variedad de canales de entrega, incluyendo correo, SMS (a través de <a href="https://www.nexmo.com/" target="_blank" rel="noopener noreferrer">Nexmo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>) y <a href="https://slack.com" target="_blank" rel="noopener noreferrer">Slack<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Las notificaciones pueden ser también almacenadas en una base de datos para que puedan ser mostradas en la interfaz de tu página web.</p> <p>Generalmente, las notificaciones deben ser mensajes cortos e informativos que notifiquen a los usuarios que algo ocurrió en tu aplicación. Por ejemplo, si estás escribiendo una aplicación de facturación, podrías enviar una notificación de &quot;Recibo de Pago&quot; a tus usuarios mediante correo electrónico y por SMS.</p> <p><a name="creating-notifications"></a></p> <h2 id="crear-notificaciones"><a class="header-anchor" href="#crear-notificaciones" aria-hidden="true">#</a> Crear Notificaciones</h2> <p>En Laravel, cada notificación está representada por una sola clase (generalmente almacenada en el directorio <code>app/Notifications</code>). No te preocupes si no ves este directorio en tu aplicación, será creada por ti cuando ejecutes el comando Artisan <code>make:notification</code>:</p> <div class="language-php extra-class"><pre v-pre class="language-php"><code>php artisan make<span class="token punctuation">:</span>notification InvoicePaid
</code></pre></div><p>Este comando colocará una clase de notificación nueva en tu directorio <code>app/Notifications</code>. Cada clase de notificación contiene un método <code>via</code> y un número variable de métodos de construcción de mensaje (tales como <code>toMail</code> o <code>toDatabase</code>) que convierten la notificación en un mensaje optimizado para ese canal en particular.</p> <p><a name="sending-notifications"></a></p> <h2 id="enviar-notificaciones"><a class="header-anchor" href="#enviar-notificaciones" aria-hidden="true">#</a> Enviar Notificaciones</h2> <p><a name="using-the-notifiable-trait"></a></p> <h3 id="usar-el-atributo-notifiable"><a class="header-anchor" href="#usar-el-atributo-notifiable" aria-hidden="true">#</a> Usar El Atributo Notifiable</h3> <p>Las notificaciones pueden ser enviadas en dos formas: usando el método <code>notify</code> del atributo <code>Notifiable</code> o usando <code>Notification</code> <a href="/docs/%7B%7Bversion%7D%7D/facades">facade</a>. Primero, exploremos el uso del atributo:</p> <div class="language-php extra-class"><pre v-pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notifiable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Notifiable</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Este atributo es utilizado por el modelo <code>App\User</code> por defecto y contiene un método que puede ser usado para enviar notificaciones: <code>notify</code>. El método <code>notify</code> espera recibir una instancia de notificación:</p> <div class="language-php extra-class"><pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>InvoicePaid</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InvoicePaid</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Recuerda que puedes usar el atributo <code>Illuminate\Notifications\Notifiable</code> en cualquiera de tus modelos. No estás limitado a incluirlo solamente en tu modelo <code>User</code>.</p></div></div> <p><a name="using-the-notification-facade"></a></p> <h3 id="usar-la-facade-notification"><a href="#usar-la-facade-notification" aria-hidden="true" class="header-anchor">#</a> Usar la Facade Notification</h3> <p>Alternativamente, puedes enviar notificaciones mediante la <a href="/docs/%7B%7Bversion%7D%7D/facades">facade</a> <code>Notification</code>. Esto es útil principalmente cuando necesitas enviar una notificación a múltiples entidades notificables, como un grupo de usuarios. Para enviar notificaciones usando la facade, pasa todas las entidades notificables y la instancia de notificación al método <code>send</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>Notification<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token variable">$users</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InvoicePaid</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="specifying-delivery-channels"></a></p> <h3 id="especificar-canales-de-entrega"><a href="#especificar-canales-de-entrega" aria-hidden="true" class="header-anchor">#</a> Especificar Canales De Entrega</h3> <p>Cada clase de notificación tiene un método <code>via</code> que determina mediante cuáles canales será entregada la notificación. Las notificaciones pueden ser enviadas por los canales  <code>mail</code>, <code>database</code>, <code>broadcast</code>, <code>nexmo</code>, y <code>slack</code>.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Si estás interesado en utilizar otros canales de entrega como Telegram o Pusher, revisa el sitio dirigido por la comunidad <a href="http://laravel-notification-channels.com" target="_blank" rel="noopener noreferrer">Laravel Notification Channels<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <p>El método <code>via</code> recibe una instancia <code>$notifiable</code> la cual será una instancia de la clase a la cual la notificación está siendo enviada. Puedes usar <code>$notifiable</code> para determinar mediante cuáles canales debería ser entregada la notificación:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the notification's delivery channels.
*
* @param  mixed  $notifiable
* @return array
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">via</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$notifiable</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">prefers_sms</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'nexmo'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'mail'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="queueing-notifications"></a></p> <h3 id="notificaciones-en-cola"><a href="#notificaciones-en-cola" aria-hidden="true" class="header-anchor">#</a> Notificaciones En Cola</h3> <div class="danger custom-block"><p class="custom-block-title">Nota</p> <p>Antes de poner notificaciones en cola, se debe configurar una cola y <a href="/docs/%7B%7Bversion%7D%7D/queues">activar un worker</a>.</p></div> <p>Enviar notificaciones puede tomar tiempo, especialmente si el canal necesita una API externa para llamar o entregar la notificación. Para acelerar el tiempo de respuesta de tu notificación, permite que sea puesta en cola añadiendo la interfaz <code>ShouldQueue</code> y el atributo <code>Queueable</code> a tu clase. La interfaz y el atributo son importados para todas las notificaciones generadas usando <code>make:notification</code>, así que puedesn añadir de inmediato a tu clase de notificación:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Notifications</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Bus<span class="token punctuation">\</span>Queueable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notification</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Queue<span class="token punctuation">\</span>ShouldQueue</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">InvoicePaid</span> <span class="token keyword">extends</span> <span class="token class-name">Notification</span> <span class="token keyword">implements</span> <span class="token class-name">ShouldQueue</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Queueable</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Una vez que la interfaz <code>ShouldQueue</code> haya sido agregada a tu notificación, puedes enviarla con normalidad. Laravel detectará <code>ShouldQueue</code> en la clase y automáticamente pondrá en cola la entrega de la notificación:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InvoicePaid</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Si quisieras retrasar la entrega de la notificación, puedes encadenar el método <code>delay</code> al instanciar tu notificación:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$when</span> <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">addMinutes</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InvoicePaid</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">delay</span><span class="token punctuation">(</span><span class="token variable">$when</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="on-demand-notifications"></a></p> <h3 id="notificaciones-bajo-demanda"><a href="#notificaciones-bajo-demanda" aria-hidden="true" class="header-anchor">#</a> Notificaciones Bajo Demanda</h3> <p>A veces puede que necesites enviar una notificación a alguien que no está almacenado como &quot;usuario&quot; de tu aplicación. Usando el método <code>Notification::route</code>, puedes especificar información de enrutamiento para una notificación ad-hoc antes de enviarla:</p> <div class="language-php extra-class"><pre class="language-php"><code>Notification<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mail'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'taylor@example.com'</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'nexmo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'5555555555'</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InvoicePaid</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="mail-notifications"></a></p> <h2 id="notificaciones-por-correo"><a href="#notificaciones-por-correo" aria-hidden="true" class="header-anchor">#</a> Notificaciones Por Correo</h2> <p><a name="formatting-mail-messages"></a></p> <h3 id="formato-de-mensajes-por-correo"><a href="#formato-de-mensajes-por-correo" aria-hidden="true" class="header-anchor">#</a> Formato De Mensajes Por Correo</h3> <p>Si una notificación tiene soporte para ser enviada por correo, se debe definir un método <code>toMail</code> en la clase de la notificación. Este método recibirá una entidad <code>$notifiable</code> y debe devolver una instancia <code>Illuminate\Notifications\Messages\MailMessage</code>. Los mensajes por correo pueden contener líneas de texto, así como una &quot;llamada a la acción&quot;. Observemos un método <code>toMail</code> de ejemplo:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the mail representation of the notification.
*
* @param  mixed  $notifiable
* @return \Illuminate\Notifications\Messages\MailMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toMail</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/invoice/'</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MailMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">greeting</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Hello!'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'One of your invoices has been paid!'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'View Invoice'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Thank you for using our application!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Nota que se está usando el método <code>$this-&gt;invoice-&gt;id</code> en el método <code>toMail</code>. Puedes pasar cualquier dato que la notificación necesite para generar su mensaje dentro del constructor de la notificación.</p></div> <p>En este ejemplo, registramos un saludo, una línea de texto, un llamado a la acción y luego otra línea de texto. Estos elementos proporcionados por el objeto <code>MailMessage</code> hacen que sea rápido y sencillo dar formato a pequeños correos transaccionales. El canal de correo entonces traducirá los componentes del mensaje en una plantilla HTML agradable y con capacidad de respuesta, justo con su contraparte de texto simple. He aquí un ejemplo de un correo generado por el canal <code>mail</code>:</p> <img src="https://laravel.com/assets/img/notification-example.png" width="551" height="596"> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Al enviar notificaciones por correo, asegúrate de establecer el valor <code>name</code> en tu archivo <code>config/app.php</code>. Este valor será usado en el encabezado y pie de los mensajes de notificación por correo.</p></div> <h4 id="otras-opciones-de-formato-para-notificaciones"><a href="#otras-opciones-de-formato-para-notificaciones" aria-hidden="true" class="header-anchor">#</a> Otras Opciones De Formato Para Notificaciones</h4> <p>En lugar de definir las &quot;líneas&quot; de texto en la clase notification, puedes usar el método <code>view</code> para especificar una plantilla personalizada que debe ser usada para renderizar el correo de notificación:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the mail representation of the notification.
*
* @param  mixed  $notifiable
* @return \Illuminate\Notifications\Messages\MailMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toMail</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MailMessage</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">view</span><span class="token punctuation">(</span>
        <span class="token single-quoted-string string">'emails.name'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'invoice'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">invoice</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Además, puedes devolver un <a href="/docs/%7B%7Bversion%7D%7D/mail">objeto mailable</a> desde el método <code>toMail</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Mail<span class="token punctuation">\</span>InvoicePaid</span> <span class="token keyword">as</span> Mailable<span class="token punctuation">;</span>

<span class="token comment">/**
* Get the mail representation of the notification.
*
* @param  mixed  $notifiable
* @return Mailable
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toMail</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Mailable</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">email</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="error-messages"></a></p> <h4 id="mensajes-de-error"><a href="#mensajes-de-error" aria-hidden="true" class="header-anchor">#</a> Mensajes De Error</h4> <p>Algunas notificaciones informan a los usuarios acerca de errores, como un pago fallido. puedes indicar que un mensaje por correo se refiere a un error llamando al método <code>error</code> cuando se construye el mensaje. Al usar el método <code>error</code> en un mensaje por correo, el botón de llamado a la acción será rojo en vez de azul:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the mail representation of the notification.
*
* @param  mixed  $notifiable
* @return \Illuminate\Notifications\Message
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toMail</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MailMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Notification Subject'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="customizing-the-sender"></a></p> <h3 id="personalizar-el-remitente"><a href="#personalizar-el-remitente" aria-hidden="true" class="header-anchor">#</a> Personalizar El Remitente</h3> <p>Por defecto, el remitente del correo electrónico es definido en el archivo <code>config/mail.php</code>. Sin embargo, también puedes definir un remitente a través de una notificación específica:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the mail representation of the notification.
*
* @param  mixed  $notifiable
* @return \Illuminate\Notifications\Messages\MailMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toMail</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MailMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'noreply@laravel.com'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Laravel'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="customizing-the-recipient"></a></p> <h3 id="personalizar-el-destinatario"><a href="#personalizar-el-destinatario" aria-hidden="true" class="header-anchor">#</a> Personalizar El Destinatario</h3> <p>Al enviar notificaciones mediante el canal <code>mail</code>, el sistema de notificaciones automáticamente buscará una propiedad <code>email</code> en tu entidad notificable. Puedes personalizar la dirección de correo electrónico usada para entregar la notificación definiendo el método <code>routeNotificationForMail</code> en la entidad:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notifiable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Notifiable</span><span class="token punctuation">;</span>

    <span class="token comment">/**
    * Route notifications for the mail channel.
    *
    * @param  \Illuminate\Notifications\Notification  $notification
    * @return string
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">routeNotificationForMail</span><span class="token punctuation">(</span><span class="token variable">$notification</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">email_address</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p><a name="customizing-the-subject"></a></p> <h3 id="personalizar-el-asunto"><a href="#personalizar-el-asunto" aria-hidden="true" class="header-anchor">#</a> Personalizar El Asunto</h3> <p>Por defecto, el asunto del correo electrónico es el nombre de la clase de notificación formateada a &quot;title case&quot;. Así que si tu clase de notificación se llama <code>InvoicePaid</code>, el asunto del correo será <code>Invoice Paid</code>. Si se prefiere especificar un asunto explícito para el mensaje, puedes llamar al método <code>subject</code> al construir el mensaje:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the mail representation of the notification.
*
* @param  mixed  $notifiable
* @return \Illuminate\Notifications\Messages\MailMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toMail</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MailMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Notification Subject'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="customizing-the-templates"></a></p> <h3 id="personalizar-las-plantillas"><a href="#personalizar-las-plantillas" aria-hidden="true" class="header-anchor">#</a> Personalizar Las Plantillas</h3> <p>Puedes modificar las plantillas HTML y de texto simple usadas por las notificaciones de correo publicando los recursos del paquete de notificación. Luego de ejecutar este comando, las plantillas de notificación de correo estarán ubicadas en el directorio <code>resources/views/vendor/notifications</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>php artisan vendor<span class="token punctuation">:</span>publish <span class="token operator">--</span>tag<span class="token operator">=</span>laravel<span class="token operator">-</span>notifications
</code></pre></div><p><a name="previewing-mail-notifications"></a></p> <h3 id="previsualizar-notificaciones-de-correo"><a href="#previsualizar-notificaciones-de-correo" aria-hidden="true" class="header-anchor">#</a> Previsualizar Notificaciones De Correo</h3> <p>Al diseñar una plantilla de notificación de correo, es conveniente previsualizar rápidamente el mensaje de correo renderizado en tu navegador como una plantilla normal de Blade. Por esta razón, Laravel te permite retornar cualquier mensaje de correo generado por una notificación de correo directamente desde un Closure de ruta o un controlador. Cuando un <code>MailMessage</code> es retornado, este será renderizado y mostrado en el navegador, permitiendote previsualizar rápidamente su diseño sin necesidad de enviarlo a un correo electrónico real:</p> <div class="language-php extra-class"><pre class="language-php"><code>Route<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mail'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$invoice</span> <span class="token operator">=</span> App\<span class="token package">Invoice</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">App<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>InvoicePaid</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">toMail</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="markdown-mail-notifications"></a></p> <h2 id="notificaciones-por-correo-markdown"><a href="#notificaciones-por-correo-markdown" aria-hidden="true" class="header-anchor">#</a> Notificaciones Por Correo Markdown</h2> <p>Las notificaciones por correo Markdown permiten tomar ventaja de las plantillas prefabricadas para notificaciones por correo, dando a su vez libertad para escribir mensajes más largos y personalizados. Como los mensajes están escritos en Markdown, Laravel puede renderizar plantillas HTML bellas y responsivas para los mensajes y a la vez generar automáticamente su contraparte en texto simple.</p> <p><a name="generating-the-message"></a></p> <h3 id="generar-el-mensaje"><a href="#generar-el-mensaje" aria-hidden="true" class="header-anchor">#</a> Generar El Mensaje</h3> <p>Para generar una notificación con su plantilla Markdown correspondiente, puedes usar la opción <code>--markdown</code> del comando Artisan <code>make:notification</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>php artisan make<span class="token punctuation">:</span>notification InvoicePaid <span class="token operator">--</span>markdown<span class="token operator">=</span>mail<span class="token punctuation">.</span>invoice<span class="token punctuation">.</span>paid
</code></pre></div><p>Como todas las otras notificaciones, aquellas que usan plantillas Markdown deben definir un método <code>toMail</code> en su clase de notificación. Sin embargo, en lugar de usar los modelos <code>line</code> y <code>action</code> para construir la notificación, se usa el método <code>markdown</code> para especificar el nombre de la plantilla Markdown a ser usada:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the mail representation of the notification.
*
* @param  mixed  $notifiable
* @return \Illuminate\Notifications\Messages\MailMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toMail</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/invoice/'</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MailMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Invoice Paid'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">markdown</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mail.invoice.paid'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'url'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$url</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="writing-the-message"></a></p> <h3 id="escribir-el-mensaje"><a href="#escribir-el-mensaje" aria-hidden="true" class="header-anchor">#</a> Escribir El Mensaje</h3> <p>Las notificaciones por correo Markdown usan una combinación de componentes Blade y sintaxis Markdown que te permiten construir fácilmente notificaciones a la vez que se apalancan los componentes de notificación prefabricados por Laravel:</p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token function">component</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mail::message'</span><span class="token punctuation">)</span>
<span class="token shell-comment comment"># Invoice Paid</span>

Your invoice has been paid<span class="token operator">!</span>

@<span class="token function">component</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mail::button'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'url'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$url</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
View Invoice
@endcomponent

Thanks<span class="token punctuation">,</span><span class="token operator">&lt;</span>br<span class="token operator">&gt;</span>
<span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'app.name'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
@endcomponent
</code></pre></div><h4 id="componente-button"><a href="#componente-button" aria-hidden="true" class="header-anchor">#</a> Componente Button</h4> <p>El componente button renderiza un enlace a un botón centrado. El componente acepta dos argumentos, una <code>url</code> y un <code>color</code> opcional. LOs colores disponibles son <code>blue</code>, <code>green</code>, y <code>red</code>. Puedes añadir tantos componentes de botón a una notificación como desees:</p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token function">component</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mail::button'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'url'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'color'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'green'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
View Invoice
@endcomponent
</code></pre></div><h4 id="componente-panel"><a href="#componente-panel" aria-hidden="true" class="header-anchor">#</a> Componente Panel</h4> <p>El componente panel renderiza el bloque de texto dado en un panel que tiene un color de fondo ligeramente distinto al resto de la notificación. Esto permite poner énfasis en un determinado bloque de texto:</p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token function">component</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mail::panel'</span><span class="token punctuation">)</span>
This is the panel content<span class="token punctuation">.</span>
@endcomponent
</code></pre></div><h4 id="componente-table"><a href="#componente-table" aria-hidden="true" class="header-anchor">#</a> COmponente Table</h4> <p>TEl componente table permite transformar una tabla Markdown en una tabla HTML. El componente acepta la tabla Markdown como contenido. La alineación de columnas es soportada usando la sintaxis de alineación de tablas de Markdown por defecto:</p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token function">component</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mail::table'</span><span class="token punctuation">)</span>
<span class="token operator">|</span> Laravel       <span class="token operator">|</span> Table         <span class="token operator">|</span> Example  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">|</span><span class="token punctuation">:</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">:</span><span class="token operator">|</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token punctuation">:</span><span class="token operator">|</span>
<span class="token operator">|</span> Col <span class="token number">2</span> is      <span class="token operator">|</span> Centered      <span class="token operator">|</span> <span class="token variable">$10</span>      <span class="token operator">|</span>
<span class="token operator">|</span> Col <span class="token number">3</span> is      <span class="token operator">|</span> Right<span class="token operator">-</span>Aligned <span class="token operator">|</span> <span class="token variable">$20</span>      <span class="token operator">|</span>
@endcomponent
</code></pre></div><p><a name="customizing-the-components"></a></p> <h3 id="personalizar-los-componentes"><a href="#personalizar-los-componentes" aria-hidden="true" class="header-anchor">#</a> Personalizar Los Componentes</h3> <p>Puedes exportar todos los componentes de notificación de Markdown a tu propia aplicación para personalización. Para exportar los componentes, se usa el comando Artisan <code>vendor:publish</code> para publicar la etiqueta del asset <code>laravel-mail</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>php artisan vendor<span class="token punctuation">:</span>publish <span class="token operator">--</span>tag<span class="token operator">=</span>laravel<span class="token operator">-</span>mail
</code></pre></div><p>Este comando publicará los componentes de correo de Markdown al directorio <code>resources/views/vendor/mail</code>. El directorio <code>mail</code> contendrá los directorios <code>html</code> y <code>text</code>, cada uno contiene sus respectivas representaciones de cada componente disponible. Eres libre de personalizar estos componentes de acuerdo a su preferencia.</p> <h3 id="personalizar-css"><a href="#personalizar-css" aria-hidden="true" class="header-anchor">#</a> Personalizar CSS</h3> <p>Después de exportar los componentes, el directorio <code>resources/views/vendor/mail/html/themes</code> contendrá un archivo <code>default.css</code>. Puedes personalizar el CSS en este archivo y los estilos automáticamente se alinearán con las representaciones HTML de las notificaciones Markdown.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Si prefieres construir un tema completamente nuevo para los componentes Markdown, escribe un nuevo archivo CSS dentro del directorio <code>html/themes</code> y cambia la opción <code>theme</code> del archivo de configuración <code>mail</code>.</p></div> <p><a name="database-notifications"></a></p> <h2 id="notificaciones-de-base-de-datos"><a href="#notificaciones-de-base-de-datos" aria-hidden="true" class="header-anchor">#</a> Notificaciones De Base De Datos</h2> <p><a name="database-prerequisites"></a></p> <h3 id="prerrequisitos"><a href="#prerrequisitos" aria-hidden="true" class="header-anchor">#</a> Prerrequisitos</h3> <p>El canal de notificaciones <code>database</code> guarda la información de notificación en una tabla de base de datos. Esta tabla contendrá información como el tipo de notificación así como datos JSON personalizados que describen la notificación.</p> <p>Puedes buscar en la tabla para mostrar las notificaciones en la interfaz de usuario de la aplicación. Pero, antes de poder hacer esto, necesitarás crear una tabla de base de datos para almacenar las notificaciones. Puedes usar el comando <code>notifications:table</code> para generar una migración con el esquema de tabla apropiado:</p> <div class="language-php extra-class"><pre class="language-php"><code>php artisan notifications<span class="token punctuation">:</span>table

php artisan migrate
</code></pre></div><p><a name="formatting-database-notifications"></a></p> <h3 id="formatting-database-notifications"><a href="#formatting-database-notifications" aria-hidden="true" class="header-anchor">#</a> Formatting Database Notifications</h3> <p>Si una notificación posee soporte para ser almacenada en una tabla de base de datos, debes definir un método <code>toDatabase</code> o <code>toArray</code> en la clase de notificación. Este método recibirá una entidad <code>$notifiable</code> y debería devolver un arreglo PHP sencillo. El arreglo devuelto estará codificado como JSON y almacenado en la columna <code>data</code>de la tabla <code>notifications</code>. Observemos un ejemplo del método <code>toArray</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the array representation of the notification.
*
* @param  mixed  $notifiable
* @return array
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toArray</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'invoice_id'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'amount'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">amount</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="todatabase-vs-toarray"><a href="#todatabase-vs-toarray" aria-hidden="true" class="header-anchor">#</a> <code>toDatabase</code> Vs. <code>toArray</code></h4> <p>El método <code>toArray</code> también es usado por el canal <code>broadcast</code> para determinar cuáles datos difundir al cliente JavaScript. Si prefieres tener dos representaciones de arreglos para los canales <code>database</code> y <code>broadcast</code>, debes definir un método <code>toDatabase</code> en lugar de <code>toArray</code>.</p> <p><a name="accessing-the-notifications"></a></p> <h3 id="acceder-a-las-notificaciones"><a href="#acceder-a-las-notificaciones" aria-hidden="true" class="header-anchor">#</a> Acceder A Las Notificaciones</h3> <p>Una vez que las notificaciones se almacenan en la base de datos, necesitas una forma conveniente de acceder a ellas desde tus entidades notificables. El atributo <code>Illuminate\Notifications\Notifiable</code>, el cual está incluido en el modelo de Laravel <code>App\User</code> por defecto, incluye una relación Eloquent <code>notifications</code> que devuelve las notificaciones para la entidad. Para conseguir las notificaciones, puedes acceder a este método como a cualquier otra relación Eloquent. Por defecto, las notificaciones serán clasificadas por el timestamp <code>created_at</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span> <span class="token operator">=</span> App\<span class="token package">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">notifications</span> <span class="token keyword">as</span> <span class="token variable">$notification</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$notification</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">type</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Si quieres recibir sólo las notificaciones &quot;no leídas (unread)&quot;, puedes usar la relación <code>unreadNotifications</code>. Nuevamente, las notificaciones serán clasificadas por el timestamp <code>created_at</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span> <span class="token operator">=</span> App\<span class="token package">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">unreadNotifications</span> <span class="token keyword">as</span> <span class="token variable">$notification</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$notification</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">type</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Para acceder a las notificaciones desde el cliente JavaScript, se debe definir un controlador de notificaciones para tu aplicación que devuelva las notificaciones para una entidad notificable, como el usuario actual. puedes entonces elaborar una petición HTTP al URI de ese controlador desde el cliente JavaScript.</p></div> <p><a name="marking-notifications-as-read"></a></p> <h3 id="marcar-notificaciones-como-leidas"><a href="#marcar-notificaciones-como-leidas" aria-hidden="true" class="header-anchor">#</a> Marcar Notificaciones Como Leídas</h3> <p>Normalmente, querrás marcar una notificación como &quot;leída (read)&quot; cuando un usuario la ve. El atributo <code>Illuminate\Notifications\Notifiable</code> provee un método <code>markAsRead</code> el cual actualiza la columna <code>read_at</code> en el registro de base de datos de las notificaciones:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span> <span class="token operator">=</span> App\<span class="token package">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">unreadNotifications</span> <span class="token keyword">as</span> <span class="token variable">$notification</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$notification</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">markAsRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Sin embargo, en lugar de hacer bucle a través de cada notificación, puedes usar el método <code>markAsRead</code> directamente en un grupo de notificaciones:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">unreadNotifications</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">markAsRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Asimismo, puedes utilizar una consulta de actualización masiva para marcar todas las notificaciones como leídas sin necesidad de recuperarlas de la base de datos:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span> <span class="token operator">=</span> App\<span class="token package">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unreadNotifications</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'read_at'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Puedes hacer <code>delete</code> a las notificaciones para removerlas por completo de la tabla:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notifications</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="broadcast-notifications"></a></p> <h2 id="notificaciones-de-difusion"><a href="#notificaciones-de-difusion" aria-hidden="true" class="header-anchor">#</a> Notificaciones de Difusión</h2> <p><a name="broadcast-prerequisites"></a></p> <h3 id="prerrequisitos-2"><a href="#prerrequisitos-2" aria-hidden="true" class="header-anchor">#</a> Prerrequisitos</h3> <p>Antes de difundir notificaciones, debes configurar y familiarizarse con los servicios <a href="/docs/%7B%7Bversion%7D%7D/broadcasting">broadcasting de eventos</a> de Laravel. La difusión de eventos brinda una forma de reaccionar a los eventos de Laravel disparados por el servidor, desde el cliente JavaScript.</p> <p><a name="formatting-broadcast-notifications"></a></p> <h3 id="formato-de-notificaciones-de-difusion"><a href="#formato-de-notificaciones-de-difusion" aria-hidden="true" class="header-anchor">#</a> Formato de Notificaciones de Difusión</h3> <p>EL canal <code>broadcast</code> difunde notificaciones usando los servicios <a href="/docs/%7B%7Bversion%7D%7D/broadcasting">broadcasting de eventos</a> de Laravel, permitiéndole al cliente JavaScript capturar notificaciones en tiempo real. Si una notificación posee soporte para difusión, debes definir un método <code>toBroadcast</code> en la clase de notificación. Este método recibirá una entidad <code>$notifiable</code> y debe devolver una instancia <code>BroadcastMessage</code>. Los datos devueltos estarán codificados como JSON y se difundirán al cliente JavaScript. Observemos un ejemplo del método <code>toBroadcast</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Messages<span class="token punctuation">\</span>BroadcastMessage</span><span class="token punctuation">;</span>

<span class="token comment">/**
* Get the broadcastable representation of the notification.
*
* @param  mixed  $notifiable
* @return BroadcastMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toBroadcast</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BroadcastMessage</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'invoice_id'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'amount'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">amount</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="broadcast-queue-configuration"><a href="#broadcast-queue-configuration" aria-hidden="true" class="header-anchor">#</a> Broadcast Queue Configuration</h4> <p>Todas las notificaciones de difusión son puestas en cola para ser difundidas. Si prefieres configurar la conexión a la cola o el nombre de la cola usada para las operaciones de difusión, puedes usar los métodos <code>onConnection</code> y <code>onQueue</code> de <code>BroadcastMessage</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BroadcastMessage</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onConnection</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'sqs'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onQueue</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'broadcasts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Adicional a los datos especificados, las notificaciones de difusión contendrán también un campo <code>type</code> que contiene el nombre de clase de la notificación.</p></div> <p><a name="listening-for-notifications"></a></p> <h3 id="escuchar-notificaciones"><a href="#escuchar-notificaciones" aria-hidden="true" class="header-anchor">#</a> Escuchar Notificaciones</h3> <p>Las notificaciones se difundirán en un canal privado formateado utilizando la convención <code>{notifiable}.{id}</code>. Por lo tanto, si estás enviando una notificación a una instancia <code>App\User</code> con una ID de <code>1</code>, la notificación será difundida en el canal privado <code>App.User.1</code>. Al usar <a href="/docs/%7B%7Bversion%7D%7D/broadcasting">Laravel Echo</a>, puedes fácilmente escuchar notificaciones en un canal utilizando el método helper <code>notification</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">Echo</span><span class="token punctuation">.</span><span class="token keyword">private</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'App.User.'</span> <span class="token operator">+</span> userId<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">notification</span><span class="token punctuation">(</span><span class="token punctuation">(</span>notification<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>notification<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="personalizar-el-canal-de-notificacion"><a href="#personalizar-el-canal-de-notificacion" aria-hidden="true" class="header-anchor">#</a> Personalizar El Canal De Notificación</h4> <p>Si quieres personalizar los canales mediante los cuales una entidad notificable recibe sus notificaciones de difusión, puedes definir un método <code>receivesBroadcastNotificationsOn</code> en la entidad notificable:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notifiable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>PrivateChannel</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Notifiable</span><span class="token punctuation">;</span>

    <span class="token comment">/**
    * The channels the user receives notification broadcasts on.
    *
    * @return string
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">receivesBroadcastNotificationsOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token single-quoted-string string">'users.'</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p><a name="sms-notifications"></a></p> <h2 id="notificaciones-por-sms"><a href="#notificaciones-por-sms" aria-hidden="true" class="header-anchor">#</a> Notificaciones Por SMS</h2> <p><a name="sms-prerequisites"></a></p> <h3 id="prerrequisitos-3"><a href="#prerrequisitos-3" aria-hidden="true" class="header-anchor">#</a> Prerrequisitos</h3> <p>El envío de notificaciones por SMS en Laravel trabaja con <a href="https://www.nexmo.com/" target="_blank" rel="noopener noreferrer">Nexmo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Antes de poder enviar notificaciones mediante Nexmo, necesitas instalar el paquete Composer <code>laravel/nexmo-notification-channel</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>composer <span class="token keyword">require</span> laravel<span class="token operator">/</span>nexmo<span class="token operator">-</span>notification<span class="token operator">-</span>channel
</code></pre></div><p>Luego, necesitas agregar algunas opciones de configuración al archivo <code>config/services.php</code>. Puedes copiar el ejemplo de configuración siguiente para empezar:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token single-quoted-string string">'nexmo'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'key'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'NEXMO_KEY'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'secret'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'NEXMO_SECRET'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'sms_from'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'15556666666'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>La opción <code>sms_from</code> es el número de teléfono remitente de los mensajes SMS. Se debe generar un número de teléfono para la aplicación en el panel de control de Nexmo.</p> <p><a name="formatting-sms-notifications"></a></p> <h3 id="formato-de-notificaciones-de-sms"><a href="#formato-de-notificaciones-de-sms" aria-hidden="true" class="header-anchor">#</a> Formato De Notificaciones De SMS</h3> <p>Si una notificación tiene soporte para ser enviada mediante SMS, debes definir un método <code>toNexmo</code> en la clase de notificación. Este método recibirá una entidad <code>$notifiable</code> y debe devolver una instancia <code>Illuminate\Notifications\Messages\NexmoMessage</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the Nexmo / SMS representation of the notification.
*
* @param  mixed  $notifiable
* @return NexmoMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toNexmo</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NexmoMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Your SMS message content'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="contenido-unicode"><a href="#contenido-unicode" aria-hidden="true" class="header-anchor">#</a> Contenido Unicode</h4> <p>Si el mensaje SMS contiene caracteres Unicode, debes llamar al método <code>unicode</code> al construir la instancia <code>NexmoMessage</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the Nexmo / SMS representation of the notification.
*
* @param  mixed  $notifiable
* @return NexmoMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toNexmo</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NexmoMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Your unicode message'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unicode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="customizing-the-from-number"></a></p> <h3 id="personalizando-el-numero-remitente"><a href="#personalizando-el-numero-remitente" aria-hidden="true" class="header-anchor">#</a> Personalizando El Número Remitente</h3> <p>Si deseas enviar algunas notificaciones desde un número telefónico diferente al especificado en el archivo <code>config/services.php</code>, puedes usar el método <code>from</code> en una instancia <code>NexmoMessage</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the Nexmo / SMS representation of the notification.
*
* @param  mixed  $notifiable
* @return NexmoMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toNexmo</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NexmoMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Your SMS message content'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'15554443333'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="routing-sms-notifications"></a></p> <h3 id="enrutar-notificaciones-por-sms"><a href="#enrutar-notificaciones-por-sms" aria-hidden="true" class="header-anchor">#</a> Enrutar Notificaciones Por SMS</h3> <p>Al enviar notificaciones a través del canal <code>nexmo</code>, el sistema de notificaciones buscará automáticamente por un atributo <code>phone_number</code> en la entidad notificable. Si deseas personalizar el número telefónico al cual la notificación será entregada, define un método <code>routeNotificationForNexmo</code> en la entidad:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notifiable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Notifiable</span><span class="token punctuation">;</span>

    <span class="token comment">/**
    * Route notifications for the Nexmo channel.
    *
    * @param  \Illuminate\Notifications\Notification  $notification
    * @return string
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">routeNotificationForNexmo</span><span class="token punctuation">(</span><span class="token variable">$notification</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">phone</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p><a name="slack-notifications"></a></p> <h2 id="notificaciones-por-slack"><a href="#notificaciones-por-slack" aria-hidden="true" class="header-anchor">#</a> Notificaciones Por Slack</h2> <p><a name="slack-prerequisites"></a></p> <h3 id="prerrequisitos-4"><a href="#prerrequisitos-4" aria-hidden="true" class="header-anchor">#</a> Prerrequisitos</h3> <p>Antes de poder enviar notificaciones mediante Slack, debes instalar el paquete para el canal de notificación mediante Composer:</p> <div class="language-php extra-class"><pre class="language-php"><code>composer <span class="token keyword">require</span> laravel<span class="token operator">/</span>slack<span class="token operator">-</span>notification<span class="token operator">-</span>channel
</code></pre></div><p>También necesitarás configurar una integración <a href="https://api.slack.com/incoming-webhooks" target="_blank" rel="noopener noreferrer">&quot;Incoming Webhook&quot;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> para tu equipo en Slack. Esta integración proveerá una URL utilizable para <a href="#routing-slack-notifications">enrutamiento de notificaciones de Slack</a>.</p> <p><a name="formatting-slack-notifications"></a></p> <h3 id="formato-de-notificaciones-por-slack"><a href="#formato-de-notificaciones-por-slack" aria-hidden="true" class="header-anchor">#</a> Formato De Notificaciones Por Slack</h3> <p>Si una notificación tiene soporte para ser enviada como mensaje por Slack, debes definir un método <code>toSlack</code> en la clase de notificación. EL método recibirá una entidad <code>$notifiable</code> y debe devolver una instancia <code>Illuminate\Notifications\Messages\SlackMessage</code>. Los mensajes de Slack pueden contener texto así como un &quot;archivo adjunto&quot; que formatea texto adicional o un arreglo de campos. Observemos un ejemplo básico de <code>toSlack</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the Slack representation of the notification.
*
* @param  mixed  $notifiable
* @return SlackMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toSlack</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SlackMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'One of your invoices has been paid!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>En este ejemplo estamos solamente enviando una línea de texto a Slack, la cual creará un mensaje que luce como éste:</p> <img src="https://laravel.com/assets/img/basic-slack-notification.png"> <h4 id="personalizar-el-remitente-y-destinatario"><a href="#personalizar-el-remitente-y-destinatario" aria-hidden="true" class="header-anchor">#</a> Personalizar el Remitente y Destinatario</h4> <p>Puedes usar los métodos <code>from</code> y <code>to</code> para personalizar el remitente y el destinatario. El método <code>from</code> acepta un nombre de usuario y un identificador emoji, mientras que el método <code>to</code> acepta un canal y un usuario:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the Slack representation of the notification.
*
* @param  mixed  $notifiable
* @return SlackMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toSlack</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SlackMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Ghost'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">':ghost:'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'#other'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'This will be sent to #other'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>También puedes utilizar una imagen como logo en vez de un emoji:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the Slack representation of the notification.
*
* @param  mixed  $notifiable
* @return SlackMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toSlack</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SlackMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Laravel'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'https://laravel.com/favicon.png'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'This will display the Laravel logo next to the message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="slack-attachments"></a></p> <h3 id="archivos-adjuntos-en-slack"><a href="#archivos-adjuntos-en-slack" aria-hidden="true" class="header-anchor">#</a> Archivos Adjuntos En Slack</h3> <p>También puedes añadir &quot;adjuntos&quot; a los mensajes en Slack. Éstos brindan opciones de formato más amplias que mensajes de texto simple. En este ejemplo, enviaremos una notificación de error acerca de una excepción que ocurrió en una aplicación, incluyendo un enlace para ver más detalles sobre la excepción:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the Slack representation of the notification.
*
* @param  mixed  $notifiable
* @return SlackMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toSlack</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/exceptions/'</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">exception</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SlackMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Whoops! Something went wrong.'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">attachment</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$attachment</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token variable">$attachment</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Exception: File Not Found'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span>
                                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'File [background.jpg] was not found.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>El ejemplo anterior generará un mensaje en Slack como el siguiente:</p> <img src="https://laravel.com/assets/img/basic-slack-attachment.png"> <p>Los adjuntos te permitirán especificar un arreglo de datos que deben ser presentados al usuario. Los datos dados serán presentados en forma de tabla para su fácil lectura:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the Slack representation of the notification.
*
* @param  mixed  $notifiable
* @return SlackMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toSlack</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/invoices/'</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SlackMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'One of your invoices has been paid!'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">attachment</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$attachment</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token variable">$attachment</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Invoice 1322'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span>
                                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                                    <span class="token single-quoted-string string">'Title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Server Expenses'</span><span class="token punctuation">,</span>
                                    <span class="token single-quoted-string string">'Amount'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'$1,234'</span><span class="token punctuation">,</span>
                                    <span class="token single-quoted-string string">'Via'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'American Express'</span><span class="token punctuation">,</span>
                                    <span class="token single-quoted-string string">'Was Overdue'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">':-1:'</span><span class="token punctuation">,</span>
                                <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>EL ejemplo anterior generará un mensaje en Slack como el siguiente:</p> <img src="https://laravel.com/assets/img/slack-fields-attachment.png"> <h4 id="contenido-adjunto-en-markdown"><a href="#contenido-adjunto-en-markdown" aria-hidden="true" class="header-anchor">#</a> Contenido Adjunto en Markdown</h4> <p>Si algunos de tus campos adjuntos contienen Markdown, puedes usar el método <code>markdown</code> para instruir a Slack procesar y mostrar los campos proporcionados como texto formateado en Markdown. Los valores aceptados por este método son: <code>pretext</code>, <code>text</code>, y / o <code>fields</code>. Para más información sobre formato de adjuntos de Slack, revisa la <a href="https://api.slack.com/docs/message-formatting#message_formatting" target="_blank" rel="noopener noreferrer">documentación del API de Slack<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Get the Slack representation of the notification.
*
* @param  mixed  $notifiable
* @return SlackMessage
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toSlack</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/exceptions/'</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">exception</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SlackMessage</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Whoops! Something went wrong.'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">attachment</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$attachment</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token variable">$attachment</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Exception: File Not Found'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span>
                                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'File [background.jpg] was *not found*.'</span><span class="token punctuation">)</span>
                                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">markdown</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="routing-slack-notifications"></a></p> <h3 id="enrutar-notificaciones-de-slack"><a href="#enrutar-notificaciones-de-slack" aria-hidden="true" class="header-anchor">#</a> Enrutar Notificaciones De Slack</h3> <p>Para enrutar notificaciones de Slack a la ubicación apropiada, debes definir un método <code>routeNotificationForSlack</code> en tu entidad notificable. Esto debería devolver un webhook URL al cual debe ser entregada la notificación. Las Webhook URLs puedn ser generadas añadiendo un servicio &quot;Incoming Webhook&quot; a tu equipo Slack:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notifiable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Notifiable</span><span class="token punctuation">;</span>

    <span class="token comment">/**
    * Route notifications for the Slack channel.
    *
    * @param  \Illuminate\Notifications\Notification  $notification
    * @return string
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">routeNotificationForSlack</span><span class="token punctuation">(</span><span class="token variable">$notification</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token single-quoted-string string">'https://hooks.slack.com/services/...'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p><a name="localizing-notifications"></a></p> <h2 id="configuracion-regional-de-notificaciones"><a href="#configuracion-regional-de-notificaciones" aria-hidden="true" class="header-anchor">#</a> Configuración Regional De Notificaciones</h2> <p>Laravel te permite enviar notificaciones en una configuración regional distinta al idioma actual e incluso recordará esta configuración si la notificación está encolada.</p> <p>Para lograr esto, la clase <code>Illuminate\Notifications\Notification</code> ofrece un método <code>locale</code> para establecer el idioma deseado. La aplicación cambiará a esta configuración cuando la notificación esté siendo formateada y luego se revertirá a la configuración regional previa cuando el formato esté completo:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InvoicePaid</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">locale</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'es'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>La configuración regional de múltiples entradas notificables también puede ser logradas mediante la facade <code>Notification</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>Notification<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">locale</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'es'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token variable">$users</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InvoicePaid</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="configuracion-regional-preferida-por-el-usuario"><a href="#configuracion-regional-preferida-por-el-usuario" aria-hidden="true" class="header-anchor">#</a> Configuración Regional Preferida Por El Usuario</h3> <p>A veces, las aplicaciones almacenan la configuración regional preferida de cada usuario. Al implementar la interfaz <code>HasLocalePreference</code> en tu modelo notificable, puedes instruir a Laravel que use esta configuración almacenada al enviar una notificación:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Translation<span class="token punctuation">\</span>HasLocalePreference</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token keyword">implements</span> <span class="token class-name">HasLocalePreference</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Get the user's preferred locale.
    *
    * @return string
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">preferredLocale</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">locale</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Una vez esté implementada la interfaz, Laravel usará automáticamentela configuración regional preferida al enviar notificaciones y mailables al modelo. Por lo tanto, no es necesario llamar al método <code>locale</code> cuando usas esta interfaz:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InvoicePaid</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a name="notification-events"></a></p> <h2 id="eventos-de-notificacion"><a href="#eventos-de-notificacion" aria-hidden="true" class="header-anchor">#</a> Eventos De Notificación</h2> <p>Cuando una notificación es enviada, el evento <code>Illuminate\Notifications\Events\NotificationSent</code> es desencadenado por el sistema de notificación. Esto contiene la entidad &quot;notifiable&quot; y la instancia de ntificación en sí. Puedes registrar listeners para este evento en tu <code>EventServiceProvider</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* The event listener mappings for the application.
*
* @var array
*/</span>
<span class="token keyword">protected</span> <span class="token variable">$listen</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'Illuminate\Notifications\Events\NotificationSent'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'App\Listeners\LogNotification'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Luego de registrar listeners en tu <code>EventServiceProvider</code>, usa el comando Artisan <code>event:generate</code> para generar rápidamente clases de listeners.</p></div> <p>Dentro de un listener de eventos, puedes acceder a las propiedades <code>notifiable</code>, <code>notification</code> y <code>channel</code> del evento para aprender más acerca de el destinatario de la notificación o sobre la notificación en sí:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
* Handle the event.
*
* @param  NotificationSent  $event
* @return void
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>NotificationSent <span class="token variable">$event</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// $event-&gt;channel</span>
    <span class="token comment">// $event-&gt;notifiable</span>
    <span class="token comment">// $event-&gt;notification</span>
    <span class="token comment">// $event-&gt;response</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a name="custom-channels"></a></p> <h2 id="canales-personalizados"><a href="#canales-personalizados" aria-hidden="true" class="header-anchor">#</a> Canales Personalizados</h2> <p>Laravel viene una gran cantidad de canales de notificación, pero puedes ser deseable escribir controladores propios para entregar notificaciones mediante otros canales. Laravel hace de esto algo sencillo. Para empezar, debes definir una clase que contenga un método <code>send</code> El método debe recibir dos argumentos: un <code>$notifiable</code> y un <code>$notification</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Channels</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notification</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">VoiceChannel</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
    * Send the given notification.
    *
    * @param  mixed  $notifiable
    * @param  \Illuminate\Notifications\Notification  $notification
    * @return void
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">,</span> Notification <span class="token variable">$notification</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$message</span> <span class="token operator">=</span> <span class="token variable">$notification</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">toVoice</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Send notification to the $notifiable instance...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Una vez que la clase de notificación ha sido definida, puedes devolver el nombre de la clase desde el método <code>via</code> de cualquier notificación:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Notifications</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Bus<span class="token punctuation">\</span>Queueable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Channels<span class="token punctuation">\</span>VoiceChannel</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Channels<span class="token punctuation">\</span>Messages<span class="token punctuation">\</span>VoiceMessage</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notification</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Queue<span class="token punctuation">\</span>ShouldQueue</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">InvoicePaid</span> <span class="token keyword">extends</span> <span class="token class-name">Notification</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Queueable</span><span class="token punctuation">;</span>

    <span class="token comment">/**
    * Get the notification channels.
    *
    * @param  mixed  $notifiable
    * @return array|string
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">via</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>VoiceChannel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * Get the voice representation of the notification.
    *
    * @param  mixed  $notifiable
    * @return VoiceMessage
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">toVoice</span><span class="token punctuation">(</span><span class="token variable">$notifiable</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/mail.html" class="prev">
          Correos Electrónicos
        </a></span> <span class="next"><a href="/packages.html">
          Desarrollo de Paquetes
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.bf22240a.js" defer></script><script src="/assets/js/53.0a9d4aed.js" defer></script>
  </body>
</html>
