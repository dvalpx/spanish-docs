(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{248:function(e,t,a){"use strict";a.r(t);var s=a(0),r=Object(s.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{pre:!0},[e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),a("p",[e._v("Laravel hace que sea fácil proteger tu aplicación de ataques de tipo "),a("a",{pre:!0,attrs:{href:"https://en.wikipedia.org/wiki/Cross-site_request_forgery",target:"_blank",rel:"noopener noreferrer"}},[e._v("cross-site request forgery"),a("OutboundLink",{pre:!0})],1),e._v(" (CSRF). Los ataques de tipo CSRF son un tipo de explotación de vulnerabilidad malicioso por el cual comandos no autorizados son ejecutados en nombre de un usuario autenticado.")]),e._v(" "),a("p",[e._v('Laravel genera automáticamente un "token" CSRF para cada sesión de usuario activa manejada por la aplicación. Este token es usado para verificar que el usuario autenticado es quien en realidad está haciendo la petición a la aplicación.')]),e._v(" "),e._m(4),e._v(" "),e._m(5),e._m(6),e._v(" "),e._m(7),e._v(" "),e._m(8),e._v(" "),e._m(9),e._v(" "),e._m(10),e._v(" "),a("p",[e._v("Algunas veces puedes desear excluir un conjunto de URIs de la protección CSRF. Por ejemplo, si estás usando "),a("a",{pre:!0,attrs:{href:"https://stripe.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Stripe"),a("OutboundLink",{pre:!0})],1),e._v(" para procesar pagos y estás utilizando su sistema webhook, necesitarás excluir tu ruta de manejador webhook de Stripe de la protección CSRF ya que Stripe no sabrá que token CSRF enviar a sus rutas.")]),e._v(" "),e._m(11),e._v(" "),e._m(12),e._m(13)]),e._v(" "),e._m(14),e._v(" "),e._m(15),e._v(" "),e._m(16),e._v(" "),e._m(17),e._m(18),e._v(" "),e._m(19),e._m(20),e._v(" "),e._m(21),e._v(" "),e._m(22),e._v(" "),e._m(23),e._v(" "),e._m(24)])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{pre:!0,attrs:{id:"proteccion-csrf"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#proteccion-csrf","aria-hidden":"true"}},[this._v("#")]),this._v(" Protección CSRF")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("a",{pre:!0,attrs:{href:"#csrf-introduction"}},[this._v("Introducción")])]),this._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#csrf-excluding-uris"}},[this._v("Excluyendo URIs")])]),this._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#csrf-x-csrf-token"}},[this._v("X-CSRF-Token")])]),this._v(" "),t("li",[t("a",{pre:!0,attrs:{href:"#csrf-x-xsrf-token"}},[this._v("X-XSRF-Token")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("a",{pre:!0,attrs:{name:"csrf-introduction"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{pre:!0,attrs:{id:"introduccion"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#introduccion","aria-hidden":"true"}},[this._v("#")]),this._v(" Introducción")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("En cualquier momento que definas un formulario HTML en tu aplicación, debes incluir un campo de token CSRF en el formulario con el propósito de que el middleware para protección CSRF pueda validar la solicitud. Puedes usar la directiva de Blade "),t("code",[this._v("@csrf")]),this._v(" para generar el campo de token:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{pre:!0,attrs:{class:"language-php extra-class"}},[a("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("form method"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[e._v('"POST"')]),e._v(" action"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[e._v('"/profile"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n    @csrf\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("form"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("El "),t("a",{pre:!0,attrs:{href:"/docs/%7B%7Bversion%7D%7D/middleware"}},[this._v("middleware")]),this._v(" "),t("code",[this._v("VerifyCsrfToken")]),this._v(", el cual es incluido en el grupo de middleware "),t("code",[this._v("web")]),this._v(", verificará automáticamente que el token en el campo de la solicitud coincida con el almacenado en la sesión.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{pre:!0,attrs:{id:"tokens-csrf-javascript"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#tokens-csrf-javascript","aria-hidden":"true"}},[this._v("#")]),this._v(" Tokens CSRF & JavaScript")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Cuando se crean aplicaciones controladas por JavaScript, es conveniente hacer que tu biblioteca HTTP de JavaScript agregue el token CSRF a cada petición saliente. Por defecto, el archivo "),t("code",[this._v("resources/js/bootstrap.js")]),this._v(" registra el valor de la meta etiqueta "),t("code",[this._v("csrf-token")]),this._v(" con la biblioteca HTTP Axios. Si no estás usando esta biblioteca, necesitarás configurar este comportamiento de forma manual para tu aplicación.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("a",{pre:!0,attrs:{name:"csrf-excluding-uris"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{pre:!0,attrs:{id:"excluyendo-las-uris-de-la-proteccion-csrf"}},[t("a",{pre:!0,attrs:{class:"header-anchor",href:"#excluyendo-las-uris-de-la-proteccion-csrf","aria-hidden":"true"}},[this._v("#")]),this._v(" Excluyendo las URIs de la Protección CSRF")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[e._v("Típicamente, deberías colocar este tipo de rutas afuera del grupo de middleware "),a("code",[e._v("web")]),e._v(" que el "),a("code",[e._v("RouteServiceProvider")]),e._v(" aplica a todas las rutas en el archivo "),a("code",[e._v("routes/web.php")]),e._v(". Sin embargo, también puedes excluir las rutas al añadir sus URIs a la propiedad "),a("code",[e._v("except")]),e._v(" del middleware "),a("code",[e._v("VerifyCsrfToken")]),e._v(":")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{pre:!0,attrs:{class:"language-php extra-class"}},[a("pre",{pre:!0,attrs:{"v-pre":"",class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[e._v("<?php")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("namespace")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[e._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("Http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("Middleware")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("use")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[e._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("Foundation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("Http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("Middleware"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("VerifyCsrfToken")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("as")]),e._v(" Middleware"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("class")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("VerifyCsrfToken")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("extends")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Middleware")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("/**\n    * The URIs that should be excluded from CSRF verification.\n    *\n    * @var array\n    */")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("protected")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$except")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[e._v("'stripe/*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[e._v("'http://example.com/foo/bar'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[e._v("'http://example.com/foo/*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{pre:!0,attrs:{class:"tip custom-block"}},[t("p",{pre:!0,attrs:{class:"custom-block-title"}},[this._v("TIP")]),this._v(" "),t("p",[this._v("El middleware CSRF está deshabilitado automáticamente al "),t("a",{pre:!0,attrs:{href:"/docs/%7B%7Bversion%7D%7D/testing"}},[this._v("ejecutar pruebas")]),this._v(".")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("a",{attrs:{name:"csrf-x-csrf-token"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"x-csrf-token"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#x-csrf-token","aria-hidden":"true"}},[this._v("#")]),this._v(" X-CSRF-TOKEN")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Además de comprobar el token CSRF como parámetro POST, el middleware "),t("code",[this._v("VerifyCsrfToken")]),this._v(" también comprobará el encabezado de solicitud "),t("code",[this._v("X-CSRF-TOKEN")]),this._v(". Podrías, por ejemplo, almacenar el token en una etiqueta "),t("code",[this._v("meta")]),this._v(" de HTML:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("meta name"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[e._v('"csrf-token"')]),e._v(" content"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[e._v('"{{ csrf_token() }}"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Entonces, una vez que has creado la etiqueta "),t("code",[this._v("meta")]),this._v(", puedes instruir una biblioteca como jQuery para añadir automáticamente el token a todos los encabezados de las peticiones. Esto proporciona protección CSRF fácil y conveniente para tus aplicaciones basadas en AJAX.")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[e._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("ajaxSetup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[e._v("'X-CSRF-TOKEN'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[e._v("'meta[name=\"csrf-token\"]'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("attr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[e._v("'content'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),t("p",[this._v("Por defecto, el archivo "),t("code",[this._v("resources/js/bootstrap.js")]),this._v(" registra el valor de la etiqueta meta "),t("code",[this._v("csrf-token")]),this._v(" con la biblioteca HTTP Axios. Si no estás usando esta biblioteca, necesitarás configurar este comportamiento de forma manual para tu aplicación.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("a",{attrs:{name:"csrf-x-xsrf-token"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"x-xsrf-token"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#x-xsrf-token","aria-hidden":"true"}},[this._v("#")]),this._v(" X-XSRF-TOKEN")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Laravel almacena el token CSRF actual en una cookie "),t("code",[this._v("XSRF-TOKEN")]),this._v(" que es incluida con cada respuesta generada por el framework. Puedes usar el valor del cookie para establecer el encabezado de la solicitud "),t("code",[this._v("X-XSRF-TOKEN")]),this._v(".")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Esta cookie primeramente es enviada por conveniencia ya que algunos frameworks JavaScript y librerías, como Angular y Axios colocan automáticamente su valor en el encabezado "),t("code",[this._v("X-XSRF-TOKEN")]),this._v(".")])}],!1,null,null,null);t.default=r.exports}}]);